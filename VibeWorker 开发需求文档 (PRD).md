# VibeWorker å¼€å‘éœ€æ±‚æ–‡æ¡£ (PRD)
## ä¸€ã€é¡¹ç›®ä»‹ç»
### 1. åŠŸèƒ½ä¸ç›®æ ‡å®šä½
**VibeWorker** æ˜¯ä¸€ä¸ªåŸºäº **Python** æ„å»ºçš„ã€è½»é‡çº§ä¸”é«˜åº¦é€æ˜çš„ AI æ•°å­—å‘˜å·¥ Agent ç³»ç»Ÿã€‚
æœ¬é¡¹ç›®ä¸è¿½æ±‚æ„å»ºåºå¤§çš„ SaaS å¹³å°ï¼Œè€Œæ˜¯è‡´åŠ›äºæ‰“é€ ä¸€ä¸ª**è¿è¡Œåœ¨æœ¬åœ°çš„ã€æ‹¥æœ‰â€œçœŸå®è®°å¿†â€çš„æ™ºèƒ½æ•°å­—å‘˜å·¥**ã€‚å®ƒå¯ä»¥å¸®åŠ©ç”¨æˆ·å¤„ç†å„ç±»ä»»åŠ¡ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºä¿¡æ¯æ£€ç´¢ã€æ•°æ®å¤„ç†ã€ä»£ç æ‰§è¡Œã€æ–‡ä»¶ç®¡ç†ç­‰ã€‚å…¶æ ¸å¿ƒå·®å¼‚åŒ–å®šä½åœ¨äºï¼š

+ **æ–‡ä»¶å³è®°å¿† (File-first Memory)**ï¼šæ‘’å¼ƒä¸é€æ˜çš„å‘é‡æ•°æ®åº“ï¼Œå›å½’æœ€åŸå§‹ã€æœ€é€šç”¨çš„ Markdown/JSON æ–‡ä»¶ç³»ç»Ÿã€‚ç”¨æˆ·çš„æ¯ä¸€æ¬¡å¯¹è¯ã€Agent çš„æ¯ä¸€æ¬¡åæ€ï¼Œéƒ½ä»¥äººç±»å¯è¯»çš„æ–‡ä»¶å½¢å¼å­˜åœ¨ã€‚
+ **æŠ€èƒ½å³æ’ä»¶ (Skills as Plugins)**ï¼šéµå¾ª Anthropic çš„ Agent Skills èŒƒå¼ï¼Œé€šè¿‡æ–‡ä»¶å¤¹ç»“æ„ç®¡ç†èƒ½åŠ›ï¼Œå®ç°â€œæ‹–å…¥å³ç”¨â€çš„æŠ€èƒ½æ‰©å±•ã€‚
+ **é€æ˜å¯æ§**ï¼šæ‰€æœ‰çš„ System Prompt æ‹¼æ¥é€»è¾‘ã€å·¥å…·è°ƒç”¨è¿‡ç¨‹ã€è®°å¿†è¯»å†™æ“ä½œå¯¹å¼€å‘è€…å®Œå…¨é€æ˜ï¼Œæ‹’ç»â€œé»‘ç›’â€Agentã€‚

### 2. é¡¹ç›®æ ¸å¿ƒæŠ€æœ¯æ¶æ„
æœ¬é¡¹ç›®è¦æ±‚å®Œå…¨é‡‡ç”¨ **å‰åç«¯åˆ†ç¦»** æ¶æ„ï¼Œåç«¯ä½œä¸ºçº¯ API æœåŠ¡è¿è¡Œã€‚

+ **åç«¯è¯­è¨€**ï¼šPython 3.10+ (å¼ºåˆ¶ä½¿ç”¨ Type Hinting)ã€‚
+ **Web æ¡†æ¶**ï¼š**FastAPI** (æä¾› RESTful æ¥å£ï¼Œæ”¯æŒå¼‚æ­¥å¤„ç†)ã€‚
+ **Agent ç¼–æ’å¼•æ“**ï¼š**LangChain 1.x (Stable Release)**ã€‚
    - **æ ¸å¿ƒ API**ï¼šå¿…é¡»ä½¿ç”¨ `**create_agent**` API (`from langchain.agents import create_agent`)ã€‚è¿™æ˜¯ LangChain 1.0 ç‰ˆæœ¬å‘å¸ƒçš„æœ€æ–°æ ‡å‡† APIï¼Œç”¨äºæ„å»ºåŸºäº Graph è¿è¡Œæ—¶çš„ Agentã€‚
    - **æ ¸å¿ƒè¯´æ˜**ï¼šä¸¥ç¦ä½¿ç”¨æ—§ç‰ˆçš„ `AgentExecutor` æˆ–æ—©æœŸçš„ `create_react_agent`ï¼ˆæ—§é“¾å¼ç»“æ„ï¼‰ã€‚`create_agent` åº•å±‚è™½ç„¶åŸºäº LangGraph è¿è¡Œæ—¶ï¼Œä½†æä¾›äº†æ›´ç®€æ´çš„æ ‡å‡†åŒ–æ¥å£ï¼Œæœ¬é¡¹ç›®åº”ç´§è·Ÿè¿™ä¸€æœ€æ–°èŒƒå¼ã€‚
+ **RAG æ£€ç´¢å¼•æ“**ï¼š**LlamaIndex (LlamaIndex Core)**ã€‚
    - ç”¨äºå¤„ç†éç»“æ„åŒ–æ–‡æ¡£çš„æ··åˆæ£€ç´¢ï¼ˆHybrid Searchï¼‰ï¼Œä½œä¸º Agent çš„çŸ¥è¯†å¤–æŒ‚ã€‚
+ **æ¨¡å‹æ¥å£**ï¼šå…¼å®¹ OpenAI API æ ¼å¼ï¼ˆæ”¯æŒ OpenRouter, Zenmux ç­‰èšåˆæ¨¡å‹å¹³å°ï¼Œå¹¶ä¸”ä¹Ÿæ”¯æŒç”¨æˆ·è‡ªå·±é…ç½®APIåœ°å€å’ŒKeyï¼‰ã€‚
+ **æ•°æ®å­˜å‚¨**ï¼šæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ (Local File System) ä¸ºä¸»ï¼Œä¸å¼•å…¥ MySQL/Redis ç­‰é‡å‹ä¾èµ–ã€‚
+ **æ•°æ®ç›®å½•éš”ç¦» âœ… å·²å®ç°**ï¼šæ‰€æœ‰ç”¨æˆ·å¯å†™æ•°æ®ï¼ˆä¼šè¯ã€è®°å¿†ã€æŠ€èƒ½ã€é…ç½®ç­‰ï¼‰å­˜å‚¨åœ¨ `~/.vibeworker/` ç›®å½•ï¼Œä¸é¡¹ç›®æºç å®Œå…¨åˆ†ç¦»ã€‚`DATA_DIR` ç¯å¢ƒå˜é‡æ”¯æŒè‡ªå®šä¹‰ï¼Œä½†å†…ç½®å®‰å…¨æ ¡éªŒç¡®ä¿æ•°æ®ç›®å½•ä¸ä¼šæŒ‡å‘é¡¹ç›®æºç ç›®å½•å†…ï¼ˆå¦‚æ„å¤–è®¾ä¸º `.` æˆ–ç›¸å¯¹è·¯å¾„æ—¶è‡ªåŠ¨å›é€€åˆ° `~/.vibeworker/`ï¼‰ã€‚
+ **ä¼šè¯çº§ä¸´æ—¶ç›®å½•éš”ç¦» âœ… å·²å®ç°**ï¼š
    - æ¯ä¸ªä¼šè¯æ‹¥æœ‰ç‹¬ç«‹çš„å·¥ä½œç›®å½• `~/.vibeworker/tmp/{session_id}/`
    - `terminal` å’Œ `python_repl` å·¥å…·çš„ cwd è‡ªåŠ¨åˆ‡æ¢åˆ°å½“å‰ä¼šè¯çš„ä¸´æ—¶ç›®å½•
    - é€šè¿‡ `session_context.py` æ¨¡å—çº§å˜é‡ç®¡ç†ä¼šè¯ä¸Šä¸‹æ–‡ï¼ˆé¿å… ContextVar åœ¨çº¿ç¨‹æ± ä¸­ä¸ä¼ æ’­çš„é—®é¢˜ï¼‰
    - ä¼šè¯éš”ç¦»ç¡®ä¿å¤šä¼šè¯å¹¶å‘æ—¶æ–‡ä»¶æ“ä½œä¸äº’ç›¸å¹²æ‰°
+ **æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ** âœ… å·²å®ç°ï¼š
    - åŒå±‚ç¼“å­˜æ¶æ„ï¼ˆL1 å†…å­˜ + L2 ç£ç›˜ï¼‰
    - æ”¯æŒ URL ç¼“å­˜ã€LLM ç¼“å­˜ã€Prompt ç¼“å­˜ã€ç¿»è¯‘ç¼“å­˜
    - é€šç”¨å·¥å…·ç¼“å­˜è£…é¥°å™¨ï¼Œå¯ä¸ºä»»ä½•å·¥å…·æ·»åŠ ç¼“å­˜èƒ½åŠ›
    - æ˜¾è‘—æå‡å“åº”é€Ÿåº¦ï¼ˆ10-100xï¼‰å¹¶èŠ‚çœ API æˆæœ¬

## äºŒã€å†…ç½®å·¥å…·
VibeWorker åœ¨å¯åŠ¨æ—¶ï¼Œé™¤äº†åŠ è½½ç”¨æˆ·è‡ªå®šä¹‰çš„ Skills å¤–ï¼Œå¿…é¡»å†…ç½®ä»¥ä¸‹ 7 ä¸ªæ ¸å¿ƒåŸºç¡€å·¥å…·ï¼ˆCore Toolsï¼‰ã€‚æ ¹æ®"ä¼˜å…ˆä½¿ç”¨ LangChain åŸç”Ÿå·¥å…·"çš„åŸåˆ™ï¼ŒæŠ€æœ¯é€‰å‹æ›´æ–°å¦‚ä¸‹ï¼š

### 1. å‘½ä»¤è¡Œæ“ä½œå·¥å…· (Command Line Interface)
+ **åŠŸèƒ½æè¿°**ï¼šå…è®¸ Agent åœ¨å—é™çš„å®‰å…¨ç¯å¢ƒä¸‹æ‰§è¡Œ Shell å‘½ä»¤ã€‚
+ **å®ç°é€»è¾‘**ï¼š
    - **ç›´æ¥ä½¿ç”¨ LangChain å†…ç½®å·¥å…·**ï¼š`langchain_community.tools.ShellTool`ã€‚
    - **é…ç½®è¦æ±‚**ï¼š
        * åˆå§‹åŒ–æ—¶éœ€é…ç½® `root_dir` é™åˆ¶æ“ä½œèŒƒå›´ï¼ˆæ²™ç®±åŒ–ï¼‰ï¼Œé˜²æ­¢ Agent ä¿®æ”¹ç³»ç»Ÿå…³é”®æ–‡ä»¶ã€‚
        * éœ€é¢„ç½®é»‘åå•æ‹¦æˆªé«˜å±æŒ‡ä»¤ï¼ˆå¦‚ `rm -rf /`ï¼‰ã€‚
+ **å·¥å…·åç§°**ï¼š`terminal`ã€‚

### 2. Python ä»£ç è§£é‡Šå™¨ (Python REPL)
+ **åŠŸèƒ½æè¿°**ï¼šèµ‹äºˆ Agent é€»è¾‘è®¡ç®—ã€æ•°æ®å¤„ç†å’Œè„šæœ¬æ‰§è¡Œçš„èƒ½åŠ›ã€‚
+ **å®ç°é€»è¾‘**ï¼š
    - **ç›´æ¥ä½¿ç”¨ LangChain å†…ç½®å·¥å…·**ï¼š`langchain_experimental.tools.PythonREPLTool`ã€‚
    - **é…ç½®è¦æ±‚**ï¼š
        * è¯¥å·¥å…·ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„ Python äº¤äº’ç¯å¢ƒã€‚
        * **æ³¨æ„**ï¼šç”±äº `PythonREPLTool` ä½äº `experimental` åŒ…ä¸­ï¼Œéœ€ç¡®ä¿ä¾èµ–é¡¹å®‰è£…æ­£ç¡®ã€‚
+ **å·¥å…·åç§°**ï¼š`python_repl`ã€‚

### 3. Fetch ç½‘ç»œä¿¡æ¯è·å–
+ **åŠŸèƒ½æè¿°**ï¼šç”¨äºè·å–æŒ‡å®š URL çš„ç½‘é¡µå†…å®¹ï¼ŒAgent è”ç½‘çš„æ ¸å¿ƒã€‚
+ **å®ç°é€»è¾‘**ï¼š
    - **ç›´æ¥ä½¿ç”¨ LangChain å†…ç½®å·¥å…·**ï¼š`langchain_community.tools.RequestsGetTool`ã€‚
    - **å¢å¼ºé…ç½® (Wrapper)**ï¼š
        * åŸç”Ÿ `RequestsGetTool` è¿”å›çš„æ˜¯åŸå§‹ HTMLï¼ŒToken æ¶ˆè€—å·¨å¤§ã€‚
        * **å¿…é¡»å°è£…**ï¼šå»ºè®®ç»§æ‰¿è¯¥ç±»æˆ–åˆ›å»ºä¸€ä¸ª Wrapperï¼Œåœ¨è·å–å†…å®¹åä½¿ç”¨ `BeautifulSoup` æˆ– `html2text` åº“æ¸…æ´—æ•°æ®ï¼Œä»…è¿”å› Markdown æˆ–çº¯æ–‡æœ¬å†…å®¹ã€‚
+ **å·¥å…·åç§°**ï¼š`fetch_url`ã€‚

### 4. æ–‡ä»¶è¯»å–å·¥å…· (File Reader)
+ **åŠŸèƒ½æè¿°**ï¼šç”¨äºç²¾å‡†è¯»å–æœ¬åœ°æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚è¿™æ˜¯ Agent Skills æœºåˆ¶çš„æ ¸å¿ƒä¾èµ–ï¼Œç”¨äºè¯»å– `SKILL.md` çš„è¯¦ç»†è¯´æ˜ã€‚
+ **å®ç°é€»è¾‘**ï¼š
    - **ç›´æ¥ä½¿ç”¨ LangChain å†…ç½®å·¥å…·**ï¼š`langchain_community.tools.file_management.ReadFileTool`ã€‚
    - **é…ç½®è¦æ±‚**ï¼š
        * å¿…é¡»è®¾ç½® `root_dir` ä¸ºé¡¹ç›®æ ¹ç›®å½•ï¼Œä¸¥ç¦ Agent è¯»å–é¡¹ç›®ä»¥å¤–çš„ç³»ç»Ÿæ–‡ä»¶ã€‚
+ **å·¥å…·åç§°**ï¼š`read_file`ã€‚

### 5. RAG æ£€ç´¢å·¥å…· (Hybrid Retrieval)
+ **åŠŸèƒ½æè¿°**ï¼šå½“ç”¨æˆ·è¯¢é—®å…·ä½“çš„çŸ¥è¯†åº“å†…å®¹ï¼ˆéå¯¹è¯å†å²ï¼‰æ—¶ï¼ŒAgent å¯è°ƒç”¨æ­¤å·¥å…·è¿›è¡Œæ·±åº¦æ£€ç´¢ã€‚
+ **æŠ€æœ¯é€‰å‹**ï¼š**LlamaIndex**ã€‚
+ **å®ç°é€»è¾‘**ï¼š
    - **ç´¢å¼•æ„å»º**ï¼šæ”¯æŒæ‰«ææŒ‡å®šç›®å½•ï¼ˆå¦‚ `knowledge/`ï¼‰ä¸‹çš„ PDF/MD/TXT æ–‡ä»¶ï¼Œæ„å»ºæœ¬åœ°ç´¢å¼•ã€‚
    - **æ··åˆæ£€ç´¢**ï¼šå¿…é¡»å®ç° **Hybrid Search**ï¼ˆå…³é”®è¯æ£€ç´¢ BM25 + å‘é‡æ£€ç´¢ Vector Searchï¼‰ã€‚
    - **æŒä¹…åŒ–**ï¼šç´¢å¼•æ–‡ä»¶éœ€æŒä¹…åŒ–å­˜å‚¨åœ¨æœ¬åœ°ï¼ˆ`storage/`ï¼‰ã€‚
+ **å·¥å…·åç§°**ï¼š`search_knowledge_base`ã€‚

### 6. è®°å¿†å†™å…¥å·¥å…· (Memory Write) âœ… å·²å®ç°
+ **åŠŸèƒ½æè¿°**ï¼šAgent ä¸“ç”¨è®°å¿†å†™å…¥å·¥å…·ï¼Œæ›¿ä»£åŸæœ‰çš„ `terminal echo >>` æ–¹å¼ï¼Œæä¾›æ ¼å¼æ ¡éªŒã€è‡ªåŠ¨å»é‡å’Œåˆ†ç±»ç®¡ç†ã€‚
+ **å®ç°é€»è¾‘**ï¼š
    - è‡ªå®šä¹‰ LangChain `@tool` å®ç°ï¼Œè°ƒç”¨ `MemoryManager` æ ¸å¿ƒç±»ã€‚
    - **å†™å…¥æ¨¡å¼**ï¼š
        * `write_to="memory"` â†’ å†™å…¥ `MEMORY.md` å¯¹åº”åˆ†ç±»ç« èŠ‚ï¼ˆpreferences/facts/tasks/reflections/generalï¼‰
        * `write_to="daily"` â†’ è¿½åŠ åˆ°ä»Šå¤©çš„ Daily Logï¼ˆ`memory/logs/YYYY-MM-DD.md`ï¼‰
    - **è‡ªåŠ¨å»é‡**ï¼šç›¸åŒå†…å®¹ä¸ä¼šé‡å¤å†™å…¥ã€‚
    - **æ ¼å¼è§„èŒƒ**ï¼šæ¡ç›®è‡ªåŠ¨æ·»åŠ æ—¥æœŸå’Œå”¯ä¸€ IDï¼ˆ`- [YYYY-MM-DD][id] å†…å®¹`ï¼‰ã€‚
+ **å·¥å…·åç§°**ï¼š`memory_write`ã€‚

### 7. è®°å¿†æœç´¢å·¥å…· (Memory Search) âœ… å·²å®ç°
+ **åŠŸèƒ½æè¿°**ï¼šè·¨æ‰€æœ‰è®°å¿†æ–‡ä»¶ï¼ˆMEMORY.md + Daily Logsï¼‰è¿›è¡Œè¯­ä¹‰æœç´¢æˆ–å…³é”®è¯æœç´¢ã€‚
+ **å®ç°é€»è¾‘**ï¼š
    - **ä¼˜å…ˆä½¿ç”¨** LlamaIndex VectorStoreIndex è¿›è¡Œè¯­ä¹‰æœç´¢ï¼ˆå¤ç”¨ç°æœ‰ Embedding é…ç½®ï¼‰ã€‚
    - **é™çº§æ–¹æ¡ˆ**ï¼šå½“å‘é‡ç´¢å¼•ä¸å¯ç”¨æ—¶ï¼ˆEmbedding æœªé…ç½®ã€ä¾èµ–ç¼ºå¤±ï¼‰ï¼Œè‡ªåŠ¨é™çº§ä¸ºçº¯ Python å…³é”®è¯åŒ¹é…æœç´¢ã€‚
    - **ç´¢å¼•æŒä¹…åŒ–**ï¼šå‘é‡ç´¢å¼•å­˜å‚¨åœ¨ `storage/memory_index/`ï¼Œé‡å¯å¯å¤ç”¨ã€‚
    - **ç´¢å¼•é‡å»º**ï¼šé€šè¿‡ `POST /api/memory/reindex` æˆ– `rebuild_memory_index()` å¼ºåˆ¶é‡å»ºã€‚
+ **å·¥å…·åç§°**ï¼š`memory_search`ã€‚

## ä¸‰ã€æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ âœ… å·²å®ç°
### 1. ç¼“å­˜ç³»ç»Ÿæ¦‚è¿°
VibeWorker å†…ç½®æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿï¼Œé€šè¿‡åŒå±‚ç¼“å­˜æ¶æ„ï¼ˆL1 å†…å­˜ + L2 ç£ç›˜ï¼‰æ˜¾è‘—æå‡æ€§èƒ½å¹¶èŠ‚çœ API æˆæœ¬ã€‚æ‰€æœ‰ç¼“å­˜ä»¥ JSON æ–‡ä»¶å½¢å¼å­˜å‚¨åœ¨æœ¬åœ° `.cache/` ç›®å½•ï¼Œå®Œå…¨é€æ˜å¯å®¡è®¡ã€‚

**æ ¸å¿ƒç‰¹æ€§ï¼š**
- **åŒå±‚ç¼“å­˜æ¶æ„**ï¼šL1 å†…å­˜ç¼“å­˜ï¼ˆæ¯«ç§’çº§è®¿é—®ï¼‰+ L2 ç£ç›˜ç¼“å­˜ï¼ˆæŒä¹…åŒ–ï¼Œè¿›ç¨‹é‡å¯åå¯å¤ç”¨ï¼‰
- **å¤šç§ç¼“å­˜ç±»å‹**ï¼šURL ç¼“å­˜ã€LLM ç¼“å­˜ã€Prompt ç¼“å­˜ã€ç¿»è¯‘ç¼“å­˜ã€é€šç”¨å·¥å…·ç¼“å­˜
- **æ™ºèƒ½å¤±æ•ˆç­–ç•¥**ï¼šåŸºäº TTLï¼ˆTime-To-Liveï¼‰è‡ªåŠ¨è¿‡æœŸï¼ŒLRUï¼ˆLeast Recently Usedï¼‰æ·˜æ±°
- **å¯è§†åŒ–æŒ‡ç¤ºå™¨**ï¼šå‰ç«¯æ˜¾ç¤º âš¡ å›¾æ ‡ï¼Œä¸€ç›®äº†ç„¶
- **çµæ´»é…ç½®**ï¼šé€šè¿‡ `.env` ç²¾ç»†æ§åˆ¶æ¯ç§ç¼“å­˜çš„å¼€å…³å’Œ TTL
- **é€šç”¨è£…é¥°å™¨**ï¼šé€šè¿‡ `@cached_tool` è£…é¥°å™¨å¯ä¸ºä»»ä½•å·¥å…·æ·»åŠ ç¼“å­˜èƒ½åŠ›

### 2. ç¼“å­˜ç±»å‹ä¸é…ç½®

| ç¼“å­˜ç±»å‹ | é»˜è®¤å¼€å…³ | é»˜è®¤ TTL | å­˜å‚¨ä½ç½® | ç”¨é€” |
|---------|---------|----------|----------|------|
| **URL ç¼“å­˜** | âœ… å¼€å¯ | 1 å°æ—¶ | `.cache/url/` | ç½‘é¡µè¯·æ±‚ç»“æœ |
| **LLM ç¼“å­˜** | âŒ å…³é—­ | 24 å°æ—¶ | `.cache/llm/` | Agent å“åº”ï¼ˆé»˜è®¤å…³é—­ä»¥ä¿æŒæ¢ç´¢æ€§ï¼‰ |
| **Prompt ç¼“å­˜** | âœ… å¼€å¯ | 10 åˆ†é’Ÿ | `.cache/prompt/` | System Prompt æ‹¼æ¥ç»“æœ |
| **ç¿»è¯‘ç¼“å­˜** | âœ… å¼€å¯ | 7 å¤© | `.cache/translate/` | ç¿»è¯‘ API ç»“æœ |
| **å·¥å…·ç¼“å­˜** | å¯é€‰ | è‡ªå®šä¹‰ | `.cache/tool_*/` | ä»»ä½•è‡ªå®šä¹‰å·¥å…· |

**ç¯å¢ƒå˜é‡é…ç½®ï¼š**
```bash
# å¼€å…³æ§åˆ¶
ENABLE_URL_CACHE=true
ENABLE_LLM_CACHE=false          # é»˜è®¤å…³é—­
ENABLE_PROMPT_CACHE=true
ENABLE_TRANSLATE_CACHE=true

# TTL é…ç½®ï¼ˆç§’ï¼‰
URL_CACHE_TTL=3600              # 1 å°æ—¶
LLM_CACHE_TTL=86400             # 24 å°æ—¶
PROMPT_CACHE_TTL=600            # 10 åˆ†é’Ÿ
TRANSLATE_CACHE_TTL=604800      # 7 å¤©

# å†…å­˜ç¼“å­˜é™åˆ¶
CACHE_MAX_MEMORY_ITEMS=100      # L1 ç¼“å­˜æœ€å¤§æ¡ç›®æ•°

# ç£ç›˜ç¼“å­˜é™åˆ¶
CACHE_MAX_DISK_SIZE_MB=5120     # æœ€å¤§ 5GB
```

### 3. ç¼“å­˜å·¥ä½œåŸç†

**åŒå±‚ç¼“å­˜æ¶æ„ï¼š**
```
Application Layer (Tools / Agent)
    â†“
L1 Cache (Memory)
- Python dict + TTL
- LRU eviction
- æ¯«ç§’çº§è®¿é—®
    â†“ (Miss)
L2 Cache (Disk)
- JSON files in .cache/
- 2-level directory structure
- æŒä¹…åŒ–ï¼Œè¿›ç¨‹é‡å¯åå¯å¤ç”¨
    â†“ (Miss)
Original Source (API/File/etc.)
```

**ç¼“å­˜é”®ç”Ÿæˆç­–ç•¥ï¼š**
- **URL ç¼“å­˜**ï¼š`SHA256(url)`
- **LLM ç¼“å­˜**ï¼š`SHA256(system_prompt_hash + recent_history + message + model + temperature)`
- **Prompt ç¼“å­˜**ï¼š`SHA256(file_mtimes)`ï¼ˆåŸºäºæ–‡ä»¶ä¿®æ”¹æ—¶é—´ï¼Œæ–‡ä»¶å˜åŒ–è‡ªåŠ¨å¤±æ•ˆï¼‰
- **ç¿»è¯‘ç¼“å­˜**ï¼š`SHA256(content + target_language)`
- **å·¥å…·ç¼“å­˜**ï¼š`SHA256(tool_name + args + kwargs)`

### 4. ä¸ºè‡ªå®šä¹‰å·¥å…·æ·»åŠ ç¼“å­˜

ä½¿ç”¨é€šç”¨è£…é¥°å™¨ `@cached_tool`ï¼Œåªéœ€ä¸€è¡Œä»£ç ï¼š

```python
from cache import cached_tool

@cached_tool("my_tool", ttl=1800)  # ç¼“å­˜ 30 åˆ†é’Ÿ
def my_tool(query: str) -> str:
    """è‡ªå®šä¹‰å·¥å…·"""
    # å·¥å…·é€»è¾‘
    return result
```

**ä¸ LangChain å·¥å…·ç»“åˆï¼š**
```python
from langchain_core.tools import tool
from cache import cached_tool

@tool
@cached_tool("search_tool", ttl=1800)
def search_tool(query: str) -> str:
    """æœç´¢å·¥å…·ï¼ˆå¸¦ç¼“å­˜ï¼‰"""
    # æœç´¢é€»è¾‘
    return results
```

### 5. ç¼“å­˜æœ€ä½³å®è·µ

**âœ… åº”è¯¥ç¼“å­˜çš„æ“ä½œï¼š**
- å¤–éƒ¨ API è°ƒç”¨ï¼ˆæ…¢ã€æœ‰é€Ÿç‡é™åˆ¶ï¼‰
- ç½‘é¡µæŠ“å–ï¼ˆç›¸åŒ URL é‡å¤è®¿é—®ï¼‰
- æ•°æ®åº“æŸ¥è¯¢ï¼ˆé‡å¤æŸ¥è¯¢ç›¸åŒæ•°æ®ï¼‰
- è®¡ç®—å¯†é›†å‹æ“ä½œï¼ˆç»“æœç¡®å®šï¼‰

**âŒ ä¸åº”è¯¥ç¼“å­˜çš„æ“ä½œï¼š**
- å‘½ä»¤æ‰§è¡Œï¼ˆ`terminal`ã€`bash`ï¼‰- æ¯æ¬¡å¯èƒ½äº§ç”Ÿä¸åŒç»“æœ
- ä»£ç æ‰§è¡Œï¼ˆ`python_repl`ï¼‰- æœ‰å‰¯ä½œç”¨
- å†™æ“ä½œï¼ˆ`write_file`ï¼‰- æœ‰å‰¯ä½œç”¨
- å‘é€æ“ä½œï¼ˆ`send_email`ï¼‰- æœ‰å‰¯ä½œç”¨
- å®æ—¶æ•°æ®æŸ¥è¯¢ï¼ˆ`get_current_time`ï¼‰- å¿…é¡»æœ€æ–°
- éšæœºç”Ÿæˆï¼ˆ`random_number`ï¼‰- æ¯æ¬¡åº”è¯¥ä¸åŒ

**è¯¦ç»†æ–‡æ¡£ï¼š**
- `backend/TOOL_CACHE_GUIDE.md` - ä½¿ç”¨æŒ‡å—
- `backend/CACHE_BEST_PRACTICES.md` - æœ€ä½³å®è·µ
- `UNIVERSAL_TOOL_CACHE.md` - é€šç”¨å·¥å…·ç¼“å­˜è¯´æ˜

### 6. æ€§èƒ½æå‡

| æ“ä½œ | æ— ç¼“å­˜ | æœ‰ç¼“å­˜ï¼ˆå‘½ä¸­ï¼‰ | æå‡ |
|------|--------|---------------|------|
| **ç½‘é¡µè¯·æ±‚** | ~500-2000ms | ~10-50ms | **10-100x** |
| **LLM è°ƒç”¨** | ~2000-5000ms | ~100-300msï¼ˆæ¨¡æ‹Ÿæµï¼‰ | **10-20x** |
| **Prompt æ‹¼æ¥** | ~50-100ms | ~1-5ms | **10-50x** |
| **ç¿»è¯‘ API** | ~1000-2000ms | ~5-20ms | **50-200x** |

**æ€»ä½“æ•ˆæœï¼š**
- é‡å¤æŸ¥è¯¢åœºæ™¯ï¼šå“åº”é€Ÿåº¦æå‡ **10-100 å€**
- Token æ¶ˆè€—ï¼šå‡å°‘ **50-90%**ï¼ˆLLM ç¼“å­˜å¼€å¯æ—¶ï¼‰
- ç”¨æˆ·ä½“éªŒï¼šç›¸åŒé—®é¢˜ç§’çº§å“åº”

## å››ã€VibeWorker çš„ Agent Skills ç³»ç»Ÿ
### 1. Agent Skills åŸºç¡€åŠŸèƒ½ä»‹ç»
VibeWorker çš„ Agent Skills éµå¾ª **"Instruction-following" (æŒ‡ä»¤éµå¾ª)** èŒƒå¼ï¼Œè€Œéä¼ ç»Ÿçš„ "Function-calling" (å‡½æ•°è°ƒç”¨) èŒƒå¼ã€‚è¿™æ„å‘³ç€ Skills æœ¬è´¨ä¸Šæ˜¯**æ•™ä¼š Agent å¦‚ä½•ä½¿ç”¨åŸºç¡€å·¥å…·ï¼ˆå¦‚ Python/Terminalï¼‰å»å®Œæˆä»»åŠ¡çš„è¯´æ˜ä¹¦**ï¼Œè€Œä¸æ˜¯é¢„å…ˆå†™å¥½çš„ Python å‡½æ•°ã€‚

Agent Skills ä»¥æ–‡ä»¶å¤¹å½¢å¼å­˜åœ¨äº `backend/skills/` ç›®å½•ä¸‹ã€‚


### 2. Agent Skills è½½å…¥ä¸æ‰§è¡Œæµç¨‹
#### 2.1 Agent Skills è¯»å–æµç¨‹ (Bootstrap)
åœ¨ Agent å¯åŠ¨æˆ–ä¼šè¯å¼€å§‹æ—¶ï¼Œç³»ç»Ÿæ‰«æ `skills` æ–‡ä»¶å¤¹ï¼Œè¯»å–æ¯ä¸ª `SKILL.md` çš„å…ƒæ•°æ®ï¼ˆFrontmatterï¼‰ï¼Œå¹¶å°†å…¶æ±‡æ€»ç”Ÿæˆ `SKILLS_SNAPSHOT.md`ã€‚

`**SKILLS_SNAPSHOT.md**`** ç¤ºä¾‹ï¼š**

```plain
<available_skills>  
  <skill>  
    <name>get_weather</name>  
    <description>è·å–æŒ‡å®šåŸå¸‚çš„å®æ—¶å¤©æ°”ä¿¡æ¯</description>  
    <location>./backend/skills/get_weather/SKILL.md</location> 
  </skill>
</available_skills>
```

_æ³¨æ„ï¼š_`_location_`_ ä½¿ç”¨ç›¸å¯¹è·¯å¾„ã€‚_

#### 2.2 Agent Skills è°ƒç”¨æµç¨‹ (Execution)
è¿™æ˜¯æœ¬ç³»ç»Ÿæœ€ç‹¬ç‰¹çš„åœ°æ–¹ï¼š

1. **æ„ŸçŸ¥**ï¼šAgent åœ¨ System Prompt ä¸­çœ‹åˆ° `available_skills` åˆ—è¡¨ã€‚
2. **å†³ç­–**ï¼šå½“ç”¨æˆ·è¯·æ±‚â€œæŸ¥è¯¢åŒ—äº¬å¤©æ°”â€æ—¶ï¼ŒAgent å‘ç° `get_weather` æŠ€èƒ½åŒ¹é…ã€‚
3. **è¡ŒåŠ¨ (Tool Call)**ï¼šAgent **ä¸è°ƒç”¨**`get_weather()` å‡½æ•°ï¼ˆå› ä¸ºå®ƒä¸å­˜åœ¨ï¼‰ï¼Œè€Œæ˜¯è°ƒç”¨ `**read_file(path="./backend/skills/get_weather/SKILL.md")**`ã€‚
4. **å­¦ä¹ ä¸æ‰§è¡Œ**ï¼šAgent è¯»å– Markdown å†…å®¹ï¼Œç†è§£æ“ä½œæ­¥éª¤ï¼ˆä¾‹å¦‚ï¼šâ€œä½¿ç”¨ fetch_url è®¿é—®æŸå¤©æ°” APIâ€ æˆ– â€œä½¿ç”¨ python_repl è¿è¡Œä»¥ä¸‹ä»£ç â€ï¼‰ï¼Œç„¶å**åŠ¨æ€è°ƒç”¨ Core Tools** (Terminal/Python) æ¥å®Œæˆä»»åŠ¡ã€‚

### 3. Agent Skills çš„ä¸€äº›ç‰¹æ€§
#### 3.1 å…¼å®¹Claude Code
æœ¬å·¥ç¨‹çš„Agent Skills éœ€è¦èƒ½å…¼å®¹æœ¬åœ°çš„Claude Codeæ’ä»¶ï¼ˆå³å¦‚æœæœ¬åœ°å®‰è£…äº†ClaudeCodeï¼ŒåŒæ ·å…è®¸ç”¨æˆ·å¯ä»¥ä½¿ç”¨åˆ°å®‰è£…åœ¨ClaudeCodeé‡Œçš„Skillï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰å®‰è£…Claude Codeåˆ™æ— å½±å“ï¼‰

#### 3.2 æŠ€èƒ½å•†åº— (Skills Store) âœ… å·²å®ç°
æä¾›ä¸€ä¸ªæŠ€èƒ½å•†åº—ï¼Œé›†æˆ [skills.sh](https://skills.sh/) ç”Ÿæ€ç³»ç»Ÿï¼š

**åŠŸèƒ½ç‰¹æ€§ï¼š**
- æµè§ˆ 500+ ç¤¾åŒºæŠ€èƒ½
- æŒ‰åˆ†ç±»ç­›é€‰ï¼ˆå·¥å…·ã€æ•°æ®ã€ç½‘ç»œã€è‡ªåŠ¨åŒ–ã€é›†æˆç­‰ï¼‰
- å…³é”®è¯æœç´¢æŠ€èƒ½
- ä¸€é”®å®‰è£…åˆ°æœ¬åœ° `skills/` ç›®å½•
- åˆ†é¡µå±•ç¤ºï¼ˆæ¯é¡µ 12 ä¸ªæŠ€èƒ½ï¼‰
- æŸ¥çœ‹æŠ€èƒ½è¯¦æƒ…å’Œ SKILL.md å†…å®¹

**æŠ€æœ¯å®ç°ï¼š**
- åç«¯ `backend/store/` æ¨¡å—è´Ÿè´£ä¸ skills.sh äº¤äº’
- ä» skills.sh é¡µé¢æå–æŠ€èƒ½æ•°æ®ï¼ˆé€šè¿‡æ­£åˆ™åŒ¹é…åµŒå…¥çš„ JSONï¼‰
- ä» GitHub åŸå§‹å†…å®¹è·å– SKILL.md æ–‡ä»¶
- å‰ç«¯ `frontend/src/components/store/` æä¾›å•†åº— UI

**CLI å·¥å…·ï¼š**
```bash
# Linux/macOS
./scripts/skills.sh list              # åˆ—å‡ºæœ¬åœ°æŠ€èƒ½
./scripts/skills.sh search <query>    # æœç´¢è¿œç¨‹æŠ€èƒ½
./scripts/skills.sh install <name>    # å®‰è£…æŠ€èƒ½

# Windows
scripts\skills.bat list
scripts\skills.bat search <query>
scripts\skills.bat install <name>
```

#### 3.3 æŠ€èƒ½ç¿»è¯‘åŠŸèƒ½ âœ… å·²å®ç°
ç¼–è¾‘å™¨æ”¯æŒä¸€é”®å°† SKILL.md æ–‡ä»¶ç¿»è¯‘ä¸ºä¸­æ–‡ï¼š
- ç‚¹å‡»ç¿»è¯‘æŒ‰é’®ï¼Œè°ƒç”¨ LLM è¿›è¡Œæ™ºèƒ½ç¿»è¯‘
- ä»…ç¿»è¯‘æè¿°æ€§å†…å®¹ï¼Œä¿ç•™ä»£ç å—ã€URLã€å˜é‡åç­‰
- ç¿»è¯‘è¿‡ç¨‹ä¸­æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
- æ”¯æŒæ’¤é”€æ›´æ”¹æ¢å¤åŸæ–‡


## äº”ã€VibeWorker å¯¹è¯è®°å¿†ç®¡ç†ç³»ç»Ÿè®¾è®¡
### 1. æœ¬åœ°ä¼˜å…ˆåŸåˆ™
æ‰€æœ‰è®°å¿†æ–‡ä»¶ï¼ˆJSONï¼‰å‡å­˜å‚¨åœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œç¡®ä¿å®Œå…¨çš„æ•°æ®ä¸»æƒå’Œå¯è§£é‡Šæ€§ã€‚ä¸ä½¿ç”¨ä»»ä½•å¤–éƒ¨æ•°æ®åº“ï¼ˆæ—  SQLite/Redis/å‘é‡æ•°æ®åº“ï¼‰ï¼Œæœç´¢ç´¢å¼•ä»…ä¸ºæ´¾ç”Ÿå±‚ï¼Œå¯ä»æºæ–‡ä»¶é‡å»ºã€‚

### 2. è®°å¿†ç³»ç»Ÿ v2 æ¶æ„ âœ… å·²å®ç°

å€Ÿé‰´ Mem0 çš„ä¸‰é˜¶æ®µç®¡é“æ¶æ„ï¼ŒVibeWorker é‡‡ç”¨**å››å±‚è®°å¿†ç³»ç»Ÿ**ï¼š

#### 2.1 å››å±‚è®°å¿†æ¶æ„

| å±‚çº§ | è¯´æ˜ | å­˜å‚¨ä½ç½® |
|------|------|---------|
| **Working Memory** | å½“å‰å¯¹è¯ä¸Šä¸‹æ–‡ | å†…å­˜ (messages) |
| **Short-Term Memory** | æ¯æ—¥æ—¥å¿—ï¼Œ30å¤©å½’æ¡£ | `memory/logs/YYYY-MM-DD.json` |
| **Long-Term Memory** | æŒä¹…è®°å¿†ï¼Œæ™ºèƒ½æ•´åˆ | `memory/memory.json` |
| **Procedural Memory** | å·¥å…·ä½¿ç”¨ç»éªŒ | `memory/memory.json` (procedural åˆ†ç±») |

#### 2.2 é•¿æœŸè®°å¿† (memory.json)
+ **è·¯å¾„**ï¼š`~/.vibeworker/memory/memory.json`
+ **æ ¼å¼**ï¼šç»“æ„åŒ– JSONï¼ˆæ›¿ä»£åŸ MEMORY.mdï¼‰
+ **åˆ†ç±»**ï¼š
    - `preferences`ï¼ˆç”¨æˆ·åå¥½ï¼‰ï¼šç”¨æˆ·ä¹ æƒ¯ã€å–œå¥½ã€å·¥ä½œæ–¹å¼
    - `facts`ï¼ˆé‡è¦äº‹å®ï¼‰ï¼šé¡¹ç›®ä¿¡æ¯ã€ç¯å¢ƒé…ç½®ã€å…³é”®äº‹å®
    - `tasks`ï¼ˆä»»åŠ¡å¤‡å¿˜ï¼‰ï¼šå¾…åŠäº‹é¡¹ã€æé†’ã€æˆªæ­¢æ—¥æœŸ
    - `reflections`ï¼ˆåæ€æ—¥å¿—ï¼‰ï¼šç»éªŒæ•™è®­ã€æ”¹è¿›å»ºè®®
    - `procedural`ï¼ˆç¨‹åºç»éªŒï¼‰ï¼š**æ–°å¢** - å·¥å…·ä½¿ç”¨å¿ƒå¾—ã€ç¯å¢ƒç‰¹æ€§
    - `general`ï¼ˆé€šç”¨è®°å¿†ï¼‰ï¼šå…¶ä»–å€¼å¾—è®°ä½çš„ä¿¡æ¯
+ **å­—æ®µ**ï¼š
    - `id`: å”¯ä¸€æ ‡è¯†ç¬¦
    - `content`: è®°å¿†å†…å®¹
    - `category`: åˆ†ç±»
    - `salience`: é‡è¦æ€§è¯„åˆ† (0.0-1.0)
    - `created_at`: åˆ›å»ºæ—¶é—´
    - `last_accessed`: æœ€åè®¿é—®æ—¶é—´
    - `access_count`: è®¿é—®æ¬¡æ•°
    - `source`: æ¥æº (user_explicit/auto_extract/auto_reflection)
    - `context`: é¢å¤–ä¸Šä¸‹æ–‡ï¼ˆå¯é€‰ï¼‰

#### 2.3 æ¯æ—¥æ—¥å¿— (Daily Logs)
+ **è·¯å¾„**ï¼š`~/.vibeworker/memory/logs/YYYY-MM-DD.json`
+ **æ ¼å¼**ï¼šç»“æ„åŒ– JSONï¼ˆæ›¿ä»£åŸ .md æ ¼å¼ï¼‰
+ **ç”¨é€”**ï¼šä»»åŠ¡æ‰§è¡Œæ‘˜è¦ã€ä¸´æ—¶äº‹é¡¹ã€è‡ªåŠ¨æå–çš„è®°å¿†ã€å·¥å…·å¤±è´¥åæ€
+ **å­—æ®µ**ï¼š`time`, `type`, `content`, `category`, `tool`, `error`
+ **å½’æ¡£ç­–ç•¥**ï¼š30å¤©åè‡ªåŠ¨æ‘˜è¦å½’æ¡£ï¼Œ60å¤©ååˆ é™¤

#### 2.4 è®°å¿†æœç´¢
+ **å‘é‡æœç´¢**ï¼šåŸºäº LlamaIndex VectorStoreIndex
+ **å…³é”®è¯æœç´¢**ï¼šä½œä¸ºå‘é‡æœç´¢çš„é™çº§æ–¹æ¡ˆ
+ **ç»¼åˆç›¸å…³æ€§**ï¼š`semantic Ã— salience Ã— decay`
+ **æ—¶é—´è¡°å‡**ï¼šæŒ‡æ•°è¡°å‡æ›²çº¿ï¼ˆÎ»=0.05ï¼Œ14å¤©è¡°å‡åˆ°50%ï¼‰

#### 2.5 æ™ºèƒ½æ•´åˆ (Consolidation)
å½“æ–°è®°å¿†å†™å…¥æ—¶ï¼Œç³»ç»Ÿä½¿ç”¨ LLM å†³ç­–ï¼š
- **ADD**ï¼šæ–°è®°å¿†æ˜¯å…¨æ–°ä¿¡æ¯
- **UPDATE**ï¼šæ›´æ–°/è¡¥å……å·²æœ‰è®°å¿†
- **DELETE**ï¼šä¸å·²æœ‰è®°å¿†çŸ›ç›¾ï¼Œåˆ é™¤æ—§çš„
- **NOOP**ï¼šå·²å­˜åœ¨æˆ–æ— éœ€è®°å½•

#### 2.6 åæ€è®°å¿† (Session Reflection)
ä¼šè¯ç»“æŸæ—¶è‡ªåŠ¨åæ€ï¼š
- ä¼šè¯ç»“æŸæ—¶è§¦å‘åæ€æµç¨‹
- æå–ä¼šè¯ä¸­çš„ç»éªŒæ•™è®­å’Œæ”¹è¿›å»ºè®®
- å­˜å‚¨ä¸º `reflections` åˆ†ç±»è®°å¿†
- åœ¨ System Prompt ä¸­è‡ªåŠ¨æ³¨å…¥ç›¸å…³åæ€å†…å®¹

#### 2.7 éšå¼å¬å›
å¯¹è¯å¼€å§‹æ—¶ï¼ŒåŸºäºé¦–æ¡æ¶ˆæ¯è‡ªåŠ¨æ£€ç´¢ top-3 ç›¸å…³è®°å¿† + procedural memory æ³¨å…¥åˆ° System Promptã€‚

#### 2.8 è®°å¿†ç®¡ç†æ¨¡å— (memory/)
æ ¸å¿ƒæ¨¡å— `backend/memory/`ï¼Œæä¾›ä»¥ä¸‹èƒ½åŠ›ï¼š
+ `manager.py`: æ ¸å¿ƒç®¡ç†å™¨ï¼ˆCRUDã€è¿ç§»ã€ç»Ÿè®¡ï¼‰
+ `models.py`: æ•°æ®æ¨¡å‹ï¼ˆMemoryEntry, DailyLog ç­‰ï¼‰
+ `search.py`: æœç´¢é€»è¾‘ï¼ˆå‘é‡ + å…³é”®è¯ + è¡°å‡ï¼‰
+ `consolidator.py`: è®°å¿†æ•´åˆå™¨
+ `session_reflector.py`: ä¼šè¯çº§åæ€
+ `archiver.py`: æ—¥å¿—å½’æ¡£

### 3. ç³»ç»Ÿæç¤ºè¯ (System Prompt) æ„æˆ
System Prompt ç”±ä»¥ä¸‹éƒ¨åˆ†åŠ¨æ€æ‹¼æ¥è€Œæˆï¼ˆæŒ‰é¡ºåºï¼‰ï¼š

1. `SKILLS_SNAPSHOT.md` (èƒ½åŠ›åˆ—è¡¨)
2. `SOUL.md` (æ ¸å¿ƒè®¾å®š)
3. `IDENTITY.md` (è‡ªæˆ‘è®¤çŸ¥)
4. `USER.md` (ç”¨æˆ·ç”»åƒ)
5. `AGENTS.md` (è¡Œä¸ºå‡†åˆ™ & **è®°å¿†æ“ä½œæŒ‡å—**)
6. `MEMORY.md` (é•¿æœŸè®°å¿†) + **Daily Logs (ä»Šå¤©+æ˜¨å¤©æ—¥å¿—)**

**æˆªæ–­ç­–ç•¥**ï¼š
+ å•æ–‡ä»¶è¶… 20k å­—ç¬¦æ—¶æˆªæ–­å¹¶æ·»åŠ  `...[truncated]`
+ è®°å¿†éƒ¨åˆ†æœ‰ç‹¬ç«‹çš„ Token é¢„ç®—ï¼ˆ`MEMORY_MAX_PROMPT_TOKENS`ï¼Œé»˜è®¤ 4000 tokensï¼‰ï¼Œä¼˜å…ˆçº§ï¼šMEMORY.md > ä»Šå¤©æ—¥å¿— > æ˜¨å¤©æ—¥å¿—ï¼Œè¶…å‡ºé¢„ç®—æ—¶ä»æœ€æ—§å†…å®¹å¼€å§‹æˆªæ–­

### 4. AGENTS.md çš„é»˜è®¤é…ç½® (æ ¸å¿ƒä¿®æ­£)
ç”±äº Agent é»˜è®¤å¹¶ä¸çŸ¥é“å®ƒæ˜¯é€šè¿‡"é˜…è¯»æ–‡ä»¶"æ¥å­¦ä¹ æŠ€èƒ½çš„ï¼Œå› æ­¤å¿…é¡»åœ¨åˆå§‹åŒ–æ—¶ç”Ÿæˆä¸€ä¸ªåŒ…å«æ˜ç¡®æŒ‡ä»¤çš„ `AGENTS.md`ã€‚

+ **å¿…é¡»åŒ…å«çš„å…ƒæŒ‡ä»¤ (Meta-Instructions)**ï¼š
    - æŠ€èƒ½è°ƒç”¨åè®®ï¼ˆSKILL PROTOCOLï¼‰
    - æŠ€èƒ½åˆ›å»ºåè®®ï¼ˆSKILL CREATION PROTOCOLï¼‰
    - **è®°å¿†åè®®ï¼ˆMEMORY PROTOCOLï¼‰**ï¼š
        * å£°æ˜ `memory_write` å’Œ `memory_search` ä¸¤ä¸ªä¸“ç”¨å·¥å…·
        * è¯´æ˜é•¿æœŸè®°å¿† vs æ¯æ—¥æ—¥å¿—çš„ä½¿ç”¨åœºæ™¯
        * **å¿…é¡»**ä½¿ç”¨ `memory_write` å†™å…¥è®°å¿†ï¼Œ**ç¦æ­¢** `terminal echo >>`
        * **å¿…é¡»**ä½¿ç”¨ `memory_search` æœç´¢å†å²è®°å¿†
    - å¯¹è¯åè®®ï¼ˆCHAT PROTOCOLï¼‰

### 5. è®°å¿†é…ç½®é¡¹ âœ… å·²å®ç°

```bash
# åŸºç¡€é…ç½®
MEMORY_DAILY_LOG_DAYS=2         # System Prompt ä¸­åŠ è½½æœ€è¿‘å‡ å¤©çš„æ—¥å¿—
MEMORY_MAX_PROMPT_TOKENS=4000   # è®°å¿†åœ¨ Prompt ä¸­çš„ Token ä¸Šé™
MEMORY_INDEX_ENABLED=true       # è®°å¿†è¯­ä¹‰æœç´¢ç´¢å¼•å¼€å…³

# è®°å¿†ç³»ç»Ÿ v2 é…ç½®
MEMORY_CONSOLIDATION_ENABLED=true         # æ™ºèƒ½æ•´åˆå¼€å…³
MEMORY_SESSION_REFLECT_ENABLED=true       # ä¼šè¯çº§åæ€å¼€å…³
MEMORY_ARCHIVE_DAYS=30                    # å½’æ¡£é˜ˆå€¼ï¼ˆå¤©ï¼‰
MEMORY_DELETE_DAYS=60                     # åˆ é™¤é˜ˆå€¼ï¼ˆå¤©ï¼‰
MEMORY_DECAY_LAMBDA=0.05                  # è¡°å‡ç³»æ•°ï¼ˆ14å¤©è¡°å‡åˆ°50%ï¼‰
MEMORY_IMPLICIT_RECALL_ENABLED=true       # éšå¼å¬å›å¼€å…³
MEMORY_IMPLICIT_RECALL_TOP_K=3            # éšå¼å¬å›æ•°é‡
```

### 6. ä¼šè¯å­˜å‚¨ (Sessions)
+ **è·¯å¾„**ï¼š`backend/sessions/{session_name}.json`
+ **æ ¼å¼**ï¼šæ ‡å‡† JSON æ•°ç»„ï¼ŒåŒ…å« `user`, `assistant`, `tool` (function calls) ç±»å‹çš„å®Œæ•´æ¶ˆæ¯è®°å½•ã€‚

## å…­ã€åç«¯ API æ¥å£è§„èŒƒ (FastAPI)
åç«¯æœåŠ¡ä½œä¸ºç‹¬ç«‹è¿›ç¨‹è¿è¡Œï¼Œè´Ÿè´£ Agent é€»è¾‘ã€æ–‡ä»¶è¯»å†™å’ŒçŠ¶æ€ç®¡ç†ã€‚

+ **æœåŠ¡ç«¯å£**ï¼š`8088`
+ **åŸºç¡€ URL**ï¼š`http://localhost:8088`

### 1. æ ¸å¿ƒå¯¹è¯æ¥å£
+ **Endpoint**: `POST /api/chat`
+ **åŠŸèƒ½**: å‘é€ç”¨æˆ·æ¶ˆæ¯ï¼Œè·å– Agent å›å¤ã€‚
+ **Request**:

```plain
{
  "message": "æŸ¥è¯¢ä¸€ä¸‹åŒ—äº¬çš„å¤©æ°”",
  "session_id": "main_session",
  "stream": true
}
```

+ **Response**: æ”¯æŒ **SSE (Server-Sent Events)** æµå¼è¾“å‡ºï¼Œå®æ—¶æ¨é€ Agent çš„æ€è€ƒè¿‡ç¨‹ (Thought/Tool Calls) å’Œæœ€ç»ˆå›å¤ã€‚

### 2. æ–‡ä»¶ç®¡ç†æ¥å£ (ç”¨äºå‰ç«¯ç¼–è¾‘å™¨)
+ **Endpoint**: `GET /api/files` - è¯»å–æŒ‡å®šæ–‡ä»¶å†…å®¹ï¼ˆQuery: `path=memory/MEMORY.md`ï¼‰ã€‚
+ **Endpoint**: `POST /api/files` - ä¿å­˜æ–‡ä»¶ä¿®æ”¹ï¼ˆBody: `{ "path": "...", "content": "..." }`ï¼‰ã€‚
+ **Endpoint**: `GET /api/files/tree` - è·å–é¡¹ç›®æ–‡ä»¶æ ‘ç»“æ„ï¼ˆQuery: `root=`ï¼Œå¯é€‰å­ç›®å½•ï¼‰ã€‚

### 3. ä¼šè¯ç®¡ç†æ¥å£
+ **Endpoint**: `GET /api/sessions` - è·å–æ‰€æœ‰å†å²ä¼šè¯åˆ—è¡¨ã€‚
+ **Endpoint**: `GET /api/sessions/{session_id}` - è·å–æŒ‡å®šä¼šè¯çš„æ¶ˆæ¯è®°å½•ã€‚
+ **Endpoint**: `POST /api/sessions` - åˆ›å»ºæ–°ä¼šè¯ã€‚
+ **Endpoint**: `DELETE /api/sessions/{session_id}` - åˆ é™¤æŒ‡å®šä¼šè¯ã€‚

### 4. æŠ€èƒ½ç®¡ç†æ¥å£
+ **Endpoint**: `GET /api/skills` - è·å–æ‰€æœ‰å·²å®‰è£…æŠ€èƒ½åˆ—è¡¨ï¼ˆå« name, description, locationï¼‰ã€‚
+ **Endpoint**: `DELETE /api/skills/{skill_name}` - åˆ é™¤æŒ‡å®šæŠ€èƒ½ï¼ˆåˆ é™¤æ•´ä¸ªæŠ€èƒ½æ–‡ä»¶å¤¹ï¼‰ã€‚

### 5. çŸ¥è¯†åº“æ¥å£
+ **Endpoint**: `POST /api/knowledge/rebuild` - å¼ºåˆ¶é‡å»º RAG çŸ¥è¯†åº“ç´¢å¼•ã€‚

### 6. æ¨¡å‹æ± æ¥å£ âœ… å·²å®ç°

æ¨¡å‹é…ç½®ç»Ÿä¸€ç”±æ¨¡å‹æ± ç®¡ç†ï¼ˆ`~/.vibeworker/model_pool.json`ï¼‰ï¼Œæ›¿ä»£åŸæœ‰ `.env` ä¸­åˆ†æ•£çš„æ¨¡å‹é…ç½®ã€‚

+ **Endpoint**: `GET /api/model-pool` - è·å–æ¨¡å‹æ± åˆ—è¡¨å’Œåœºæ™¯åˆ†é…ã€‚
    - è¿”å›ï¼š`{ "models": [...], "assignments": { "llm": "id", "embedding": "id", "translate": "id" } }`
    - API Key è‡ªåŠ¨è„±æ•ï¼ˆå‰4å4ï¼Œä¸­é—´ `***`ï¼‰
+ **Endpoint**: `POST /api/model-pool` - æ·»åŠ æ¨¡å‹ã€‚
    - Body: `{ "name": "GPT-4o", "api_key": "sk-...", "api_base": "https://...", "model": "gpt-4o" }`
+ **Endpoint**: `PUT /api/model-pool/{model_id}` - æ›´æ–°æ¨¡å‹é…ç½®ã€‚
    - è„±æ•æ ¼å¼çš„ api_key ä¸ä¼šè¦†ç›–åŸå€¼
+ **Endpoint**: `DELETE /api/model-pool/{model_id}` - åˆ é™¤æ¨¡å‹ã€‚
    - å·²åˆ†é…ç»™åœºæ™¯çš„æ¨¡å‹ä¸å¯åˆ é™¤ï¼ˆ409ï¼‰ï¼Œéœ€å…ˆé‡æ–°åˆ†é…
+ **Endpoint**: `PUT /api/model-pool/assignments` - æ›´æ–°åœºæ™¯åˆ†é…ã€‚
    - Body: `{ "llm": "model_id", "embedding": "model_id", "translate": "model_id" }`
    - å˜æ›´åè‡ªåŠ¨æ¸…é™¤ Prompt ç¼“å­˜
+ **Endpoint**: `POST /api/model-pool/{model_id}/test` - æµ‹è¯•æ¨¡å‹è¿æ¥ã€‚
    - å‘é€çŸ­æç¤ºè¯æµ‹è¯•è¿é€šæ€§ï¼Œè¿”å›æ¨¡å‹å›å¤

**è‡ªåŠ¨è¿ç§»**ï¼šé¦–æ¬¡è®¿é—®æ—¶è‡ªåŠ¨ä» `.env` ä¸­çš„ `OPENAI_API_KEY`/`EMBEDDING_*`/`TRANSLATE_*` è¿ç§»åˆ°æ¨¡å‹æ± ï¼Œç›¸åŒ key+base åˆå¹¶ä¸ºä¸€æ¡ã€‚

### 7. è®¾ç½®ç®¡ç†æ¥å£
+ **Endpoint**: `GET /api/settings` - è·å–å½“å‰å…¨å±€é…ç½®ï¼ˆTemperatureã€Max Tokensã€è®°å¿†ã€ç¼“å­˜ã€å®‰å…¨ç­‰ï¼‰ï¼Œæ•°æ®è¯»å–è‡ª `~/.vibeworker/.env`ã€‚
+ **Endpoint**: `PUT /api/settings` - æ›´æ–°å…¨å±€é…ç½®ï¼Œå†™å› `.env` æ–‡ä»¶ã€‚
+ **è¯´æ˜**ï¼šæ¨¡å‹ API Key/Base/Model å·²ç”±æ¨¡å‹æ± ç®¡ç†ï¼Œ`.env` ä»…å­˜æ”¾å…¨å±€å‚æ•°å’Œéæ¨¡å‹é…ç½®ã€‚
+ **å®‰å…¨å†™å…¥ä¿æŠ¤ âœ… å·²å®ç°**ï¼šå†™å…¥å‰æ ¡éªŒç›®æ ‡è·¯å¾„ä¸åœ¨é¡¹ç›®æºç ç›®å½•ï¼ˆ`PROJECT_ROOT`ï¼‰å†…ã€‚

### 8. å¥åº·æ£€æŸ¥
+ **Endpoint**: `GET /api/health` - è¿”å›åç«¯çŠ¶æ€ã€ç‰ˆæœ¬å·å’Œå½“å‰æ¨¡å‹åç§°ã€‚

### 8. æŠ€èƒ½å•†åº—æ¥å£ âœ… å·²å®ç°
+ **Endpoint**: `GET /api/store/skills` - è·å–è¿œç¨‹æŠ€èƒ½åˆ—è¡¨ã€‚
    - Query å‚æ•°ï¼š`category`ï¼ˆåˆ†ç±»ç­›é€‰ï¼‰ã€`page`ï¼ˆé¡µç ï¼‰ã€`page_size`ï¼ˆæ¯é¡µæ•°é‡ï¼‰
    - è¿”å›ï¼šæŠ€èƒ½åˆ—è¡¨ã€æ€»æ•°ã€ç‰ˆæœ¬å·
+ **Endpoint**: `GET /api/store/search` - æœç´¢æŠ€èƒ½ã€‚
    - Query å‚æ•°ï¼š`q`ï¼ˆæœç´¢å…³é”®è¯ï¼‰
    - è¿”å›ï¼šåŒ¹é…çš„æŠ€èƒ½åˆ—è¡¨
+ **Endpoint**: `GET /api/store/skills/{name}` - è·å–æŠ€èƒ½è¯¦æƒ…ã€‚
    - è¿”å›ï¼šæŠ€èƒ½å…ƒæ•°æ®ã€SKILL.md å†…å®¹ã€æ‰€éœ€å·¥å…·ç­‰
+ **Endpoint**: `POST /api/store/install` - å®‰è£…æŠ€èƒ½ã€‚
    - Body: `{ "skill_name": "...", "version": "..." }`
    - è¿”å›ï¼šå®‰è£…çŠ¶æ€å’Œæ¶ˆæ¯
+ **Endpoint**: `POST /api/skills/{skill_name}/update` - æ›´æ–°å·²å®‰è£…æŠ€èƒ½ã€‚
+ **Endpoint**: `GET /api/store/categories` - è·å–å¯ç”¨åˆ†ç±»åˆ—è¡¨ã€‚

### 9. ç¿»è¯‘æ¥å£ âœ… å·²å®ç°
+ **Endpoint**: `POST /api/translate` - ç¿»è¯‘å†…å®¹ä¸ºä¸­æ–‡ã€‚
    - Body: `{ "content": "...", "target_language": "zh-CN" }`
    - è¿”å›ï¼š`{ "status": "ok", "translated": "...", "source_language": "en", "target_language": "zh-CN" }`
    - è¯´æ˜ï¼šä½¿ç”¨ LLM è¿›è¡Œæ™ºèƒ½ç¿»è¯‘ï¼Œä»…ç¿»è¯‘æè¿°æ€§æ–‡æœ¬ï¼Œä¿ç•™ä»£ç å—å’ŒæŠ€æœ¯æ ‡è¯†ç¬¦ã€‚

### 10. è®°å¿†ç®¡ç†æ¥å£ âœ… å·²å®ç°ï¼ˆv2 å‡çº§ï¼‰
+ **Endpoint**: `GET /api/memory/entries` - åˆ—å‡º memory.json æ¡ç›®ã€‚
    - Query å‚æ•°ï¼š`category`ï¼ˆåˆ†ç±»ç­›é€‰ï¼Œå¯é€‰ï¼‰ã€`page`ï¼ˆé¡µç ï¼‰ã€`page_size`ï¼ˆæ¯é¡µæ•°é‡ï¼‰
    - è¿”å›ï¼šæ¡ç›®åˆ—è¡¨ï¼ˆå« entry_id, content, category, timestamp, **salience**, **access_count**ï¼‰ã€æ€»æ•°ã€åˆ†é¡µä¿¡æ¯
+ **Endpoint**: `POST /api/memory/entries` - æ·»åŠ è®°å¿†æ¡ç›®ã€‚
    - Body: `{ "content": "...", "category": "preferences", "salience": 0.8 }`
    - è¿”å›ï¼šåˆ›å»ºçš„æ¡ç›®è¯¦æƒ…ï¼ˆå«è‡ªåŠ¨ç”Ÿæˆçš„ entry_idï¼‰
+ **Endpoint**: `DELETE /api/memory/entries/{entry_id}` - åˆ é™¤å•æ¡è®°å¿†ã€‚
+ **Endpoint**: `GET /api/memory/daily-logs` - åˆ—å‡ºæ‰€æœ‰ Daily Log æ–‡ä»¶ã€‚
    - è¿”å›ï¼šæ—¥å¿—åˆ—è¡¨ï¼ˆå« date, path, sizeï¼‰ï¼ŒæŒ‰æ—¥æœŸå€’åº
+ **Endpoint**: `GET /api/memory/daily-logs/{date}` - è·å–æŒ‡å®šæ—¥æœŸçš„æ—¥å¿—å†…å®¹ã€‚
+ **Endpoint**: `DELETE /api/memory/daily-logs/{date}` - åˆ é™¤æŒ‡å®šæ—¥æœŸçš„æ—¥å¿—æ–‡ä»¶ã€‚
+ **Endpoint**: `POST /api/memory/search` - æœç´¢è®°å¿†ï¼ˆv2 å‡çº§ï¼‰ã€‚
    - Body: `{ "query": "...", "top_k": 5, "use_decay": true, "category": "..." }`
    - è¿”å›ï¼šæœç´¢ç»“æœï¼ˆå« id, content, category, source, **score**, **salience**ï¼‰
+ **Endpoint**: `GET /api/memory/stats` - è®°å¿†ç»Ÿè®¡ä¿¡æ¯ã€‚
    - è¿”å›ï¼šæ€»æ¡ç›®æ•°ã€å„åˆ†ç±»è®¡æ•°ã€æ—¥å¿—æ–‡ä»¶æ•°ã€**avg_salience**ã€**version**
+ **Endpoint**: `POST /api/memory/reindex` - å¼ºåˆ¶é‡å»ºè®°å¿†æœç´¢ç´¢å¼•ã€‚

#### è®°å¿†ç³»ç»Ÿ v2 æ–°å¢æ¥å£
+ **Endpoint**: `POST /api/memory/consolidate` - æ™ºèƒ½è®°å¿†æ•´åˆã€‚
    - Body: `{ "content": "...", "category": "...", "salience": 0.5 }`
    - è¿”å›ï¼š`{ "decision": "ADD/UPDATE/DELETE/NOOP", "entry": {...} }`
+ **Endpoint**: `POST /api/memory/archive` - æ‰‹åŠ¨è§¦å‘æ—¥å¿—å½’æ¡£ã€‚
    - Query å‚æ•°ï¼š`archive_days`ï¼ˆå½’æ¡£é˜ˆå€¼ï¼‰ã€`delete_days`ï¼ˆåˆ é™¤é˜ˆå€¼ï¼‰
    - è¿”å›ï¼š`{ "archived": [...], "deleted": [...], "errors": [...] }`
+ **Endpoint**: `GET /api/memory/procedural` - è·å–ç¨‹åºæ€§è®°å¿†ã€‚
    - Query å‚æ•°ï¼š`tool`ï¼ˆæŒ‰å·¥å…·åè¿‡æ»¤ï¼Œå¯é€‰ï¼‰
    - è¿”å›ï¼š`{ "procedural": [...], "total": n }`
+ **Endpoint**: `GET /api/memory/rolling-summary` - è·å–æ»šåŠ¨æ‘˜è¦ã€‚
+ **Endpoint**: `PUT /api/memory/rolling-summary` - è®¾ç½®æ»šåŠ¨æ‘˜è¦ã€‚

### 11. ç¼“å­˜ç®¡ç†æ¥å£ âœ… å·²å®ç°
+ **Endpoint**: `GET /api/cache/stats` - è·å–ç¼“å­˜ç»Ÿè®¡ä¿¡æ¯ã€‚
    - è¿”å›ï¼šå„ç±»ç¼“å­˜çš„å‘½ä¸­ç‡ã€æœªå‘½ä¸­æ•°ã€å ç”¨å¤§å°ç­‰ç»Ÿè®¡æ•°æ®
    - åŒ…å«ï¼šURL ç¼“å­˜ã€LLM ç¼“å­˜ã€Prompt ç¼“å­˜ã€ç¿»è¯‘ç¼“å­˜çš„è¯¦ç»†ç»Ÿè®¡
+ **Endpoint**: `POST /api/cache/clear` - æ¸…ç©ºç¼“å­˜ã€‚
    - Query å‚æ•°ï¼š`cache_type`ï¼ˆurl/llm/prompt/translate/allï¼Œé»˜è®¤ allï¼‰
    - è¿”å›ï¼šæ¸…ç†ç»“æœå’ŒçŠ¶æ€
+ **Endpoint**: `POST /api/cache/cleanup` - æ¸…ç†è¿‡æœŸç¼“å­˜ã€‚
    - è‡ªåŠ¨æ¸…ç†æ‰€æœ‰è¿‡æœŸçš„ç¼“å­˜æ–‡ä»¶
    - è¿”å›ï¼šæ¸…ç†æ•°é‡å’ŒçŠ¶æ€

## ä¸ƒã€å‰ç«¯å¼€å‘è¦æ±‚
### 1. è®¾è®¡ç†å¿µä¸å¸ƒå±€æ¶æ„
å‰ç«¯é‡‡ç”¨ **IDEï¼ˆé›†æˆå¼€å‘ç¯å¢ƒï¼‰é£æ ¼**ï¼Œ**å¯æ‹–æ‹½è°ƒæ•´å®½åº¦çš„ä¸‰æ å¼å¸ƒå±€**ã€‚

+ **å·¦ä¾§ (Sidebar)**ï¼šå¯¼èˆª (Chat/Memory/Skills/Cache) + ä¼šè¯åˆ—è¡¨ã€‚
    - å®½åº¦èŒƒå›´ï¼š200px ~ 400pxï¼ˆé»˜è®¤ 256pxï¼‰ï¼Œå¯æ‹–æ‹½è°ƒæ•´ã€‚
    - **é»˜è®¤é€‰ä¸­æœ€æ–°ä¼šè¯ âœ… å·²å®ç°**ï¼šé¡µé¢é¦–æ¬¡åŠ è½½æ—¶è‡ªåŠ¨é€‰ä¸­æœ€è¿‘ä¿®æ”¹çš„ä¼šè¯ï¼ˆåç«¯æŒ‰ `st_mtime` é™åºæ’åˆ—ï¼‰ï¼Œæ›¿ä»£ç¡¬ç¼–ç çš„ `main_session` é»˜è®¤å€¼ã€‚
    - ä¼šè¯æ ‡é¢˜ï¼šæœ€å¤šæ˜¾ç¤ºä¸¤è¡Œï¼Œè¶…å‡ºæˆªæ–­ï¼›æ— æ¶ˆæ¯çš„æ–°ä¼šè¯æ˜¾ç¤ºã€Œæ–°ä¼šè¯ã€ã€‚
    - æŠ€èƒ½åˆ—è¡¨ï¼šæ¯é¡¹å³ä¾§æ˜¾ç¤ºåˆ é™¤æŒ‰é’®ï¼ˆhover å¯è§ï¼‰ï¼Œç‚¹å‡»å¼¹å‡ºç¡®è®¤ååˆ é™¤ã€‚
    - **è®°å¿†é¢æ¿ âœ… å·²å®ç°**ï¼šä¸‰ Tab è®¾è®¡
        * **è®°å¿† Tab**ï¼šæŒä¹…è®°å¿†æ¡ç›®ç®¡ç†ï¼Œåˆ†ç±»ç­›é€‰ï¼ˆå…¨éƒ¨/åå¥½/äº‹å®/ä»»åŠ¡/åæ€/é€šç”¨ï¼‰+ æœç´¢ + æ·»åŠ /åˆ é™¤
        * **æ—¥è®° Tab**ï¼šæŒ‰æ—¥æœŸå€’åºåˆ—å‡º Daily Log æ–‡ä»¶ï¼Œç‚¹å‡»åœ¨ Inspector ä¸­æ‰“å¼€ï¼Œæ”¯æŒåˆ é™¤æ—¥å¿—æ–‡ä»¶ï¼ˆhover æ˜¾ç¤ºåˆ é™¤å›¾æ ‡ï¼‰
        * **äººæ ¼ Tab**ï¼šAgent äººæ ¼å®šä¹‰æ–‡ä»¶å¿«æ·å…¥å£ï¼ˆMEMORY.md/SOUL.md/IDENTITY.md/USER.md/AGENTS.mdï¼‰
    - **ä¼šè¯åˆ—è¡¨æ»‘åŠ¨é€‰ä¸­åŠ¨ç”» âœ… å·²å®ç°**ï¼šé€‰ä¸­ä¼šè¯æ—¶æ˜¾ç¤ºå¹³æ»‘æ»‘åŠ¨çš„é«˜äº®èƒŒæ™¯æŒ‡ç¤ºå™¨ï¼Œè·Ÿéšé€‰ä¸­é¡¹ç§»åŠ¨
+ **ä¸­é—´ (Stage)**ï¼šå¯¹è¯æµ + **æ€è€ƒé“¾å¯è§†åŒ–** (Collapsible Thoughts)ã€‚
    - å®½åº¦è‡ªé€‚åº”å¡«å……å‰©ä½™ç©ºé—´ã€‚
    - **å·¥å…·è°ƒç”¨å‹å¥½åŒ–å±•ç¤º**ï¼š
        * å·¥å…·åç§°æ˜ å°„ä¸ºä¸­æ–‡æ ‡ç­¾ + Emojiï¼ˆå¦‚ `read_file` -> ğŸ“„ è¯»å–æ–‡ä»¶ã€`memory_write` -> ğŸ’¾ å­˜å‚¨è®°å¿†ã€`memory_search` -> ğŸ§  æœç´¢è®°å¿†ï¼‰ã€‚
        * è¾“å…¥å‚æ•°ä» JSON ä¸­æå–å…³é”®ä¿¡æ¯ä½œä¸ºæ‘˜è¦æ˜¾ç¤ºã€‚
        * å±•å¼€è¯¦æƒ…åï¼ŒInput å’Œ Output å‡ä½¿ç”¨ Markdown æ¸²æŸ“ï¼ˆä»£ç å—è¯­æ³•é«˜äº®ã€æ ‡é¢˜ã€åˆ—è¡¨ç­‰ï¼‰ï¼Œ`\n` è‡ªåŠ¨è½¬æ¢ä¸ºå®é™…æ¢è¡Œã€‚
    - **å·¥å…·å®¡æ‰¹å¢å¼º âœ… å·²å®ç°**ï¼š
        * é«˜é£é™©å·¥å…·ï¼ˆterminalã€python_repl ç­‰ï¼‰æ‰§è¡Œå‰å¼¹å‡ºå®¡æ‰¹å¯¹è¯æ¡†
        * æ”¯æŒã€Œå…è®¸ã€ã€Œæ‹’ç»ã€ã€Œæœ¬æ¬¡ä¼šè¯å‡å…è®¸ã€ä¸‰ç§é€‰æ‹©
        * ã€Œæœ¬æ¬¡ä¼šè¯å‡å…è®¸ã€å°†è¯¥å·¥å…·åŠ å…¥ä¼šè¯ç™½åå•ï¼Œåç»­è°ƒç”¨è‡ªåŠ¨æ‰¹å‡†ï¼Œæ— éœ€é‡å¤ç¡®è®¤
    - **ç¼“å­˜æŒ‡ç¤ºå™¨** âœ… å·²å®ç°ï¼š
        * å·¥å…·è°ƒç”¨ä½¿ç”¨ç¼“å­˜æ—¶ï¼Œæ˜¾ç¤º âš¡ å›¾æ ‡ï¼ˆç°è‰²åŠé€æ˜ï¼Œä¸æ˜¾çœ¼ï¼‰ã€‚
        * é¼ æ ‡æ‚¬åœæ˜¾ç¤ºã€Œä½¿ç”¨ç¼“å­˜ã€æç¤ºã€‚
        * è‡ªåŠ¨æ£€æµ‹åç«¯è¿”å›çš„ `[CACHE_HIT]` æ ‡è®°æˆ– `cached: true` å­—æ®µã€‚
+ **å³ä¾§ (Inspector)**ï¼šMonaco Editorï¼Œç”¨äºå®æ—¶æŸ¥çœ‹/ç¼–è¾‘æ­£åœ¨ä½¿ç”¨çš„ `SKILL.md` æˆ– `MEMORY.md`ã€‚
    - å®½åº¦èŒƒå›´ï¼š280px ~ 600pxï¼ˆé»˜è®¤ 384pxï¼‰ï¼Œå¯æ‹–æ‹½è°ƒæ•´ã€‚
+ **åˆ†éš”æ¡**ï¼šå®½ 4pxï¼Œhover æ˜¾ç¤ºè“è‰²åŠé€æ˜é«˜äº®ï¼Œæ‹–æ‹½ä¸­é«˜äº®åŠ æ·±ã€‚

### 2. æŠ€æœ¯æ ˆ
+ **æ¡†æ¶**: Next.js 14+ (App Router), TypeScript
+ **UI**: Shadcn/UI, Tailwind CSS v4, Lucide Icons
+ **Editor**: Monaco Editor (é…ç½®ä¸º Light Theme)
+ **Markdown æ¸²æŸ“**: react-markdown + remark-gfm
+ **ä»£ç è¯­æ³•é«˜äº®**: react-syntax-highlighter (Prism, oneLight ä¸»é¢˜)
+ **å­—ä½“**: Google Fonts (Inter + JetBrains Mono)ï¼Œé€šè¿‡ layout.tsx ä¸­ link æ ‡ç­¾å¼•å…¥

### 3. UI/UX é£æ ¼è§„èŒƒ
+ **è‰²è°ƒ**: **æµ…è‰² Apple é£æ ¼ (Frosty Glass)**ã€‚
    - èƒŒæ™¯ï¼šçº¯ç™½/ææµ…ç° (`#fafafa`)ï¼Œé«˜é€æ¯›ç»ç’ƒæ•ˆæœã€‚
    - å¼ºè°ƒè‰²ï¼š**æ”¯ä»˜å®è“** (Alipay Blue) æˆ– **é˜¿é‡Œæ©™**ã€‚
+ **å¯¼èˆªæ **: é¡¶éƒ¨å›ºå®šï¼ŒåŠé€æ˜ã€‚
    - å·¦ä¾§ï¼š**"VibeWorker"** + ç‰ˆæœ¬å·
    - å³ä¾§ï¼šåç«¯çŠ¶æ€æŒ‡ç¤ºå™¨ï¼ˆåœ¨çº¿/ç¦»çº¿ï¼‰+ âš™ï¸ è®¾ç½®æŒ‰é’®ï¼ˆå¼¹çª—é…ç½® LLM/Embedding æ¨¡å‹å‚æ•°ï¼‰+ Inspector å¼€å…³æŒ‰é’®
+ **è®¾ç½®å¼¹çª— (Settings Dialog)**ï¼š
    - ç‚¹å‡»å¯¼èˆªæ è®¾ç½®æŒ‰é’®æ‰“å¼€ï¼Œåˆ†ã€Œé€šç”¨ã€ã€Œæ¨¡å‹ã€ã€Œè®°å¿†ã€ã€Œä»»åŠ¡ã€ã€Œç¼“å­˜ã€ã€Œå®‰å…¨ã€å…­ä¸ª Tabã€‚
    - **é€šç”¨ Tab**ï¼šæ˜¾ç¤ºæ•°æ®ç›®å½•è·¯å¾„ï¼ˆåªè¯»ï¼‰ã€ä¸»é¢˜åˆ‡æ¢ï¼ˆæ˜äº®/æš—é»‘ï¼‰ã€‚
    - **æ¨¡å‹ Tab âœ… å·²å®ç°**ï¼šæ¨¡å‹æ± æ¶æ„ï¼Œæ›¿ä»£åŸæœ‰åˆ†æ•£çš„æ¨¡å‹é…ç½®ã€‚
        * **æ¨¡å‹æ± åˆ—è¡¨**ï¼šæ˜¾ç¤ºæ‰€æœ‰å·²é…ç½®æ¨¡å‹ï¼Œæ”¯æŒæ·»åŠ ï¼ˆå¼¹çª—è¡¨å•ï¼‰ã€ç¼–è¾‘ã€åˆ é™¤ã€æµ‹è¯•è¿æ¥ã€‚
        * **åœºæ™¯åˆ†é…**ï¼šé€šè¿‡ä¸‹æ‹‰é€‰æ‹©ä¸ºã€Œä¸»æ¨¡å‹ã€ã€ŒEmbeddingã€ã€Œç¿»è¯‘ã€ä¸‰ä¸ªåœºæ™¯åˆ†é…æ¨¡å‹ï¼Œå³æ—¶ç”Ÿæ•ˆã€‚
        * **å…¨å±€å‚æ•°**ï¼šTemperature å’Œ Max Tokensï¼Œè·Ÿéšã€Œä¿å­˜é…ç½®ã€æŒ‰é’®å†™å…¥ `.env`ã€‚
        * æ¨¡å‹é…ç½®å­˜å‚¨åœ¨ `~/.vibeworker/model_pool.json`ï¼Œä¸ `.env` åˆ†ç¦»ã€‚
    - **è®°å¿† Tab âœ… å·²å®ç°**ï¼šé…ç½®è‡ªåŠ¨æå–å¼€å…³ã€è¯­ä¹‰æœç´¢ç´¢å¼•å¼€å…³ã€æ—¥å¿—åŠ è½½å¤©æ•°ã€è®°å¿† Token é¢„ç®—ã€‚
    - ä¿å­˜åè‡ªåŠ¨å…³é—­å¼¹çª—ï¼Œå…¨å±€é…ç½®å†™å…¥åç«¯ `.env` æ–‡ä»¶ã€‚
+ **ä»£ç å—æ ·å¼**ï¼š
    - å·¥å…·è°ƒç”¨è¯¦æƒ…ä¸­çš„ä»£ç å—é‡‡ç”¨æµ…è‰²èƒŒæ™¯ï¼ˆ`#f6f8fb`ï¼‰+ è“è‰²å·¦è¾¹æ¡ + Prism è¯­æ³•é«˜äº®ã€‚
    - ä½¿ç”¨ JetBrains Mono ç­‰å®½å­—ä½“ï¼Œå­—å· `0.7rem`ã€‚


## å…«ã€å¯åŠ¨ä¸è¿è¡Œ âœ… å·²å®ç°

### 1. ä¸€é”®å¯åŠ¨è„šæœ¬
é¡¹ç›®æ ¹ç›®å½•æä¾›è·¨å¹³å°å¯åŠ¨è„šæœ¬ï¼Œæ”¯æŒå‰åç«¯åŒæ—¶å¯åŠ¨/åœæ­¢/é‡å¯ï¼š

**Linux/macOS/Git Bash:**
```bash
./start.sh              # å¯åŠ¨å‰åç«¯
./start.sh stop         # åœæ­¢æ‰€æœ‰æœåŠ¡
./start.sh restart      # é‡å¯æ‰€æœ‰æœåŠ¡
./start.sh status       # æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
./start.sh logs backend # æŸ¥çœ‹åç«¯æ—¥å¿—
./start.sh backend restart  # ä»…é‡å¯åç«¯
./start.sh frontend restart # ä»…é‡å¯å‰ç«¯
```

**Windows CMD:**
```cmd
start.bat               # å¯åŠ¨å‰åç«¯
start.bat stop          # åœæ­¢æ‰€æœ‰æœåŠ¡
start.bat restart       # é‡å¯æ‰€æœ‰æœåŠ¡
start.bat status        # æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
```

**è„šæœ¬ç‰¹æ€§ï¼š**
- è‡ªåŠ¨æ£€æµ‹å¹¶æ¿€æ´» Python è™šæ‹Ÿç¯å¢ƒï¼ˆvenv/.venvï¼‰
- PID ç®¡ç†ï¼Œé¿å…é‡å¤å¯åŠ¨
- ä¼˜é›…ç»ˆæ­¢è¿›ç¨‹ï¼Œè¶…æ—¶åå¼ºåˆ¶ç»ˆæ­¢
- æ—¥å¿—æ–‡ä»¶ä¿å­˜åœ¨ `.pids/` ç›®å½•
- å½©è‰²çŠ¶æ€è¾“å‡ºï¼ˆBash ç‰ˆæœ¬ï¼‰

### 2. æ‰‹åŠ¨å¯åŠ¨
```bash
# åç«¯ (http://localhost:8088)
cd backend && pip install -r requirements.txt && python app.py

# å‰ç«¯ (http://localhost:3000)
cd frontend && npm install && npm run dev
```

## ä¹ã€é¡¹ç›®ç›®å½•ç»“æ„å‚è€ƒ
å»ºè®® Claude Code æŒ‰ç…§ä»¥ä¸‹ç»“æ„è¿›è¡Œåˆå§‹åŒ–ï¼š

```plain
vibeworker/
â”œâ”€â”€ backend/                    # FastAPI + LangChain/LangGraphï¼ˆåªè¯»æºç ï¼‰
â”‚   â”œâ”€â”€ app.py                  # å…¥å£æ–‡ä»¶ (Port 8088)
â”‚   â”œâ”€â”€ config.py               # Pydantic Settingsï¼ˆå«æ•°æ®ç›®å½•å®‰å…¨æ ¡éªŒï¼‰
â”‚   â”œâ”€â”€ model_pool.py           # æ¨¡å‹æ± ç®¡ç†ï¼ˆCRUDã€åœºæ™¯åˆ†é…ã€resolve_modelï¼‰âœ…
â”‚   â”œâ”€â”€ prompt_builder.py       # System Prompt åŠ¨æ€æ‹¼æ¥
â”‚   â”œâ”€â”€ sessions_manager.py     # ä¼šè¯ç®¡ç†å™¨
â”‚   â”œâ”€â”€ memory/                 # è®°å¿†ç³»ç»Ÿ v2 æ¨¡å— âœ…
â”‚   â”‚   â”œâ”€â”€ __init__.py         # æ¨¡å—å…¥å£ï¼Œå¯¼å‡º memory_manager å•ä¾‹
â”‚   â”‚   â”œâ”€â”€ models.py           # æ•°æ®æ¨¡å‹ï¼ˆMemoryEntry, DailyLog ç­‰ï¼‰
â”‚   â”‚   â”œâ”€â”€ manager.py          # æ ¸å¿ƒç®¡ç†å™¨ï¼ˆCRUDã€è¿ç§»ã€ç»Ÿè®¡ï¼‰
â”‚   â”‚   â”œâ”€â”€ search.py           # æœç´¢é€»è¾‘ï¼ˆå‘é‡ + å…³é”®è¯ + è¡°å‡ï¼‰
â”‚   â”‚   â”œâ”€â”€ consolidator.py     # è®°å¿†æ•´åˆå™¨ï¼ˆADD/UPDATE/DELETE/NOOPï¼‰
â”‚   â”‚   â”œâ”€â”€ session_reflector.py # ä¼šè¯çº§åæ€
â”‚   â”‚   â”œâ”€â”€ archiver.py         # æ—¥å¿—å½’æ¡£
â”‚   â”‚   â””â”€â”€ ARCHITECTURE.md     # æ¶æ„æ–‡æ¡£
â”‚   â”œâ”€â”€ session_context.py      # ä¼šè¯ä¸Šä¸‹æ–‡ç®¡ç†ï¼ˆsession_id â†’ ä¸´æ—¶ç›®å½•æ˜ å°„ï¼‰âœ…
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ user_default/           # é¦–æ¬¡è¿è¡Œæ¨¡æ¿ï¼Œè‡ªåŠ¨å¤åˆ¶åˆ° ~/.vibeworker/
â”‚   â”‚   â”œâ”€â”€ .env                # ç¯å¢ƒå˜é‡æ¨¡æ¿ï¼ˆAPI Key ç­‰ï¼‰
â”‚   â”‚   â”œâ”€â”€ mcp_servers.json    # MCP æœåŠ¡å™¨é»˜è®¤é…ç½®
â”‚   â”‚   â”œâ”€â”€ memory/
â”‚   â”‚   â”‚   â””â”€â”€ MEMORY.md       # é•¿æœŸè®°å¿†åˆå§‹æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ workspace/          # System Prompt æ¨¡æ¿
â”‚   â”‚   â”‚   â”œâ”€â”€ SOUL.md         # æ ¸å¿ƒè®¾å®š
â”‚   â”‚   â”‚   â”œâ”€â”€ IDENTITY.md     # è‡ªæˆ‘è®¤çŸ¥
â”‚   â”‚   â”‚   â”œâ”€â”€ USER.md         # ç”¨æˆ·ç”»åƒ
â”‚   â”‚   â”‚   â””â”€â”€ AGENTS.md       # è¡Œä¸ºå‡†åˆ™ & è®°å¿†åè®®
â”‚   â”‚   â””â”€â”€ knowledge/
â”‚   â”‚       â””â”€â”€ README.md       # çŸ¥è¯†åº“è¯´æ˜
â”‚   â”œâ”€â”€ cache/                  # æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ âœ…
â”‚   â”‚   â”œâ”€â”€ __init__.py         # ç¼“å­˜æ¨¡å—å…¥å£ï¼ˆå¯¼å‡ºå…¨å±€ç¼“å­˜å®ä¾‹ï¼‰
â”‚   â”‚   â”œâ”€â”€ base.py             # åŸºç¡€ç¼“å­˜ç±»æ¥å£
â”‚   â”‚   â”œâ”€â”€ memory_cache.py     # L1 å†…å­˜ç¼“å­˜ï¼ˆLRU + TTLï¼‰
â”‚   â”‚   â”œâ”€â”€ disk_cache.py       # L2 ç£ç›˜ç¼“å­˜ï¼ˆJSON å­˜å‚¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ url_cache.py        # URL ä¸“ç”¨ç¼“å­˜
â”‚   â”‚   â”œâ”€â”€ llm_cache.py        # LLM ä¸“ç”¨ç¼“å­˜ï¼ˆå«æµå¼å¤„ç†ï¼‰
â”‚   â”‚   â”œâ”€â”€ prompt_cache.py     # Prompt æ‹¼æ¥ç¼“å­˜
â”‚   â”‚   â”œâ”€â”€ translate_cache.py  # ç¿»è¯‘ç¼“å­˜
â”‚   â”‚   â””â”€â”€ tool_cache_decorator.py # é€šç”¨å·¥å…·ç¼“å­˜è£…é¥°å™¨
â”‚   â”œâ”€â”€ store/                  # æŠ€èƒ½å•†åº—æ¨¡å— âœ…
â”‚   â”‚   â”œâ”€â”€ __init__.py         # SkillsStore æ ¸å¿ƒé€»è¾‘ (skills.sh é›†æˆ)
â”‚   â”‚   â””â”€â”€ models.py           # Pydantic æ¨¡å‹ (RemoteSkill, SkillDetail ç­‰)
â”‚   â”œâ”€â”€ tools/                  # Core Tools å®ç°ï¼ˆ7 ä¸ªå†…ç½®å·¥å…·ï¼Œåªè¯»ï¼‰
â”‚   â”‚   â”œâ”€â”€ memory_write_tool.py    # è®°å¿†å†™å…¥å·¥å…· âœ…
â”‚   â”‚   â”œâ”€â”€ memory_search_tool.py   # è®°å¿†æœç´¢å·¥å…· âœ…
â”‚   â”‚   â””â”€â”€ ...                 # terminal, python_repl, fetch_url, read_file, rag
â”‚   â”œâ”€â”€ mcp_module/             # MCP é›†æˆæ¨¡å—ï¼ˆé¿å…ä¸ pip åŒ…å†²çªï¼‰
â”‚   â”œâ”€â”€ security/               # å®‰å…¨æ²™ç®±æ¨¡å—
â”‚   â”œâ”€â”€ plan_approval.py        # Plan Approval å…±äº«æ¨¡å—
â”‚   â””â”€â”€ graph/                  # LangGraph Agent ç¼–æ’
â”‚       â””â”€â”€ agent.py            # æ··åˆ Agent æ¶æ„ï¼ˆPhase 1 + Phase 2ï¼‰
â”‚
â”œâ”€â”€ ~/.vibeworker/              # ç”¨æˆ·æ•°æ®ç›®å½•ï¼ˆæ‰€æœ‰å¯å†™æ•°æ®ï¼Œä¸æºç éš”ç¦»ï¼‰
â”‚   â”œâ”€â”€ .env                    # ç”¨æˆ·ç¯å¢ƒå˜é‡ï¼ˆå…¨å±€å‚æ•°ï¼Œé¦–æ¬¡ä» user_default/.env å¤åˆ¶ï¼‰
â”‚   â”œâ”€â”€ model_pool.json         # æ¨¡å‹æ± é…ç½®ï¼ˆæ¨¡å‹åˆ—è¡¨+åœºæ™¯åˆ†é…ï¼‰âœ…
â”‚   â”œâ”€â”€ mcp_servers.json        # MCP æœåŠ¡å™¨é…ç½®
â”‚   â”œâ”€â”€ sessions/               # JSON ä¼šè¯è®°å½•
â”‚   â”œâ”€â”€ memory/                 # è®°å¿†å­˜å‚¨ (v2)
â”‚   â”‚   â”œâ”€â”€ memory.json         # é•¿æœŸè®°å¿†ï¼ˆç»“æ„åŒ– JSONï¼Œæ›¿ä»£ MEMORY.mdï¼‰
â”‚   â”‚   â”œâ”€â”€ memory.json.bak     # è‡ªåŠ¨å¤‡ä»½
â”‚   â”‚   â””â”€â”€ logs/               # Daily Logsï¼ˆæ¯æ—¥æ—¥å¿—ï¼ŒYYYY-MM-DD.jsonï¼‰
â”‚   â”œâ”€â”€ skills/                 # Agent Skillsï¼ˆæœ¬åœ°å·²å®‰è£…æŠ€èƒ½ï¼‰
â”‚   â”œâ”€â”€ workspace/              # System Prompts (SOUL.md, AGENTS.md, etc.)
â”‚   â”œâ”€â”€ tmp/                    # ä¼šè¯ä¸´æ—¶å·¥ä½œç›®å½•ï¼ˆæ¯ä¸ªä¼šè¯ç‹¬ç«‹å­ç›®å½•ï¼‰âœ…
â”‚   â”œâ”€â”€ knowledge/              # RAG çŸ¥è¯†åº“æ–‡æ¡£
â”‚   â”œâ”€â”€ storage/                # ç´¢å¼•æŒä¹…åŒ–å­˜å‚¨
â”‚   â”œâ”€â”€ .cache/                 # ç¼“å­˜å­˜å‚¨ (url/ llm/ prompt/ translate/ tool_*/)
â”‚   â””â”€â”€ logs/                   # åº”ç”¨æ—¥å¿—
â”‚
â”œâ”€â”€ frontend/                   # Next.js 14+ (App Router)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”‚   â”œâ”€â”€ layout.tsx      # æ ¹å¸ƒå±€ (å­—ä½“å¼•å…¥)
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx        # ä¸‰æ å¯æ‹–æ‹½å¸ƒå±€
â”‚   â”‚   â”‚   â””â”€â”€ globals.css     # å…¨å±€ CSS ä¸»é¢˜ä¸ç»„ä»¶æ ·å¼
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ chat/           # ChatPanel (å¯¹è¯æµ + å·¥å…·è°ƒç”¨å¯è§†åŒ–)
â”‚   â”‚   â”‚   â”œâ”€â”€ sidebar/        # Sidebar (ä¼šè¯/è®°å¿†/æŠ€èƒ½å¯¼èˆª + å•†åº—å…¥å£)
â”‚   â”‚   â”‚   â”œâ”€â”€ MemoryPanel.tsx # è®°å¿†é¢æ¿ï¼ˆä¸‰ Tabï¼šè®°å¿†/æ—¥è®°/äººæ ¼ï¼‰âœ…
â”‚   â”‚   â”‚   â”œâ”€â”€ editor/         # InspectorPanel (Monaco Editor + ç¿»è¯‘åŠŸèƒ½)
â”‚   â”‚   â”‚   â”œâ”€â”€ store/          # æŠ€èƒ½å•†åº—ç»„ä»¶ âœ…
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SkillsStoreDialog.tsx  # å•†åº—å¼¹çª—ä¸»ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SkillCard.tsx          # æŠ€èƒ½å¡ç‰‡
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ SkillDetail.tsx        # æŠ€èƒ½è¯¦æƒ…é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ settings/       # SettingsDialog (æ¨¡å‹é…ç½®å¼¹çª—)
â”‚   â”‚   â”‚   â””â”€â”€ ui/             # Shadcn/UI åŸºç¡€ç»„ä»¶
â”‚   â”‚   â””â”€â”€ lib/
â”‚   â”‚       â”œâ”€â”€ api.ts          # API å®¢æˆ·ç«¯ (å« Store/Translate API)
â”‚   â”‚       â””â”€â”€ sessionStore.ts # ä¼šè¯çŠ¶æ€ç®¡ç†
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ scripts/                    # CLI å·¥å…· âœ…
â”‚   â”œâ”€â”€ skills.sh               # Linux/macOS æŠ€èƒ½ç®¡ç†è„šæœ¬
â”‚   â””â”€â”€ skills.bat              # Windows æŠ€èƒ½ç®¡ç†è„šæœ¬
â”‚
â”œâ”€â”€ start.sh                    # å¯åŠ¨è„šæœ¬ (Linux/macOS/Git Bash) âœ…
â”œâ”€â”€ start.bat                   # å¯åŠ¨è„šæœ¬ (Windows CMD) âœ…
â””â”€â”€ README.md
```

**æ•°æ®ç›®å½•éš”ç¦»è¯´æ˜ï¼š**
- `backend/` ä¸ºåªè¯»æºç ç›®å½•ï¼ˆ`PROJECT_ROOT`ï¼‰ï¼Œä¸å­˜å‚¨ä»»ä½•ç”¨æˆ·æ•°æ®
- `~/.vibeworker/` ä¸ºç”¨æˆ·æ•°æ®ç›®å½•ï¼ˆ`DATA_DIR`ï¼‰ï¼Œå¯é€šè¿‡ç¯å¢ƒå˜é‡è‡ªå®šä¹‰
- é¦–æ¬¡è¿è¡Œæ—¶ï¼Œ`config.py` è‡ªåŠ¨å°† `user_default/` ä¸‹çš„æ¨¡æ¿å¤åˆ¶åˆ° `~/.vibeworker/`
- å®‰å…¨æ ¡éªŒï¼š`DATA_DIR` ä¸å…è®¸æŒ‡å‘ `PROJECT_ROOT` å†…éƒ¨ï¼Œå¦åˆ™è‡ªåŠ¨å›é€€åˆ° `~/.vibeworker/`

## æ··åˆ Agent æ¶æ„ (Hybrid Agent Architecture)

VibeWorker é‡‡ç”¨ç»Ÿä¸€çš„æ··åˆ Agent æ¶æ„ï¼Œä»¥ ReAct agent ä¸ºå”¯ä¸€å…¥å£ï¼Œå½“ä»»åŠ¡éœ€è¦ç»“æ„åŒ–æ‰§è¡Œæ—¶è‡ªåŠ¨åˆ‡æ¢åˆ° Plan æ‰§è¡Œæ¨¡å¼ã€‚

### Phase 1: ReAct Agentï¼ˆç»Ÿä¸€å…¥å£ï¼‰

æ‰€æœ‰ç”¨æˆ·è¯·æ±‚éƒ½ç”± ReAct agent å¤„ç†ã€‚Agent æ‹¥æœ‰å…¨éƒ¨å·¥å…·ï¼ˆ7 ä¸ª Core Tools + plan_create + plan_update + MCP å·¥å…·ï¼‰ã€‚

- **ç®€å•ä»»åŠ¡**ï¼šç›´æ¥å›ç­”æˆ–è°ƒç”¨å·¥å…·ï¼Œæµç¨‹ç»“æŸ
- **å¤æ‚ä»»åŠ¡**ï¼šAgent è‡ªä¸»åˆ¤æ–­åè°ƒç”¨ `plan_create` å·¥å…·ï¼Œè§¦å‘ Phase 2

### Phase 2: Plan Execution Loopï¼ˆè‡ªåŠ¨è§¦å‘ï¼‰

å½“ `plan_create` è¢«è°ƒç”¨åï¼Œç³»ç»Ÿè‡ªåŠ¨è¿›å…¥ Phase 2ï¼š

1. **Approval Gate**ï¼ˆå¯é€‰ï¼‰ï¼šå¦‚æœ `plan_require_approval=true`ï¼Œå‘é€ `plan_approval_request` SSE äº‹ä»¶ï¼Œç­‰å¾…ç”¨æˆ·ç¡®è®¤
2. **Executor å­ Agent**ï¼šä¸ºæ¯ä¸ªæ­¥éª¤åˆ›å»ºç‹¬ç«‹çš„ ReAct å­ agentï¼ˆ`create_react_agent` + executor å·¥å…·é›†ï¼‰ï¼Œéš”ç¦» context
3. **æµå¼è¾“å‡º**ï¼šå­ agent çš„ token/tool/llm äº‹ä»¶ä¸ Phase 1 æ ¼å¼å®Œå…¨ä¸€è‡´
4. **Replanner è¯„ä¼°**ï¼šæ¯æ­¥å®Œæˆåè°ƒç”¨ Replanner LLM è¯„ä¼°
   - `continue`: ç»§ç»­æ‰§è¡Œä¸‹ä¸€æ­¥
   - `revise`: ä¿®æ”¹åç»­æ­¥éª¤ï¼Œå‘é€ `plan_revised` SSE äº‹ä»¶
   - `finish`: æå‰å®Œæˆï¼Œè¾“å‡ºæœ€ç»ˆå›å¤

### é…ç½®é¡¹

| é…ç½® | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `plan_enabled` | `true` | æ˜¯å¦å¯ç”¨ plan_create å·¥å…· |
| `plan_revision_enabled` | `true` | æ˜¯å¦å¯ç”¨ Replanner è¯„ä¼° |
| `plan_require_approval` | `false` | æ˜¯å¦éœ€è¦ç”¨æˆ·ç¡®è®¤åæ‰æ‰§è¡Œ |
| `plan_max_steps` | `8` | å•ä¸ªè®¡åˆ’æœ€å¤§æ­¥éª¤æ•° |

### SSE äº‹ä»¶

| äº‹ä»¶ç±»å‹ | è§¦å‘æ—¶æœº | è¯´æ˜ |
|----------|----------|------|
| `plan_created` | plan_create å·¥å…·æ‰§è¡Œ | å‰ç«¯æ˜¾ç¤º PlanCard |
| `plan_updated` | æ­¥éª¤çŠ¶æ€å˜æ›´ | æ›´æ–°æ­¥éª¤çŠ¶æ€ (running/completed/failed) |
| `plan_revised` | Replanner ä¿®æ”¹æ­¥éª¤ | æ›´æ–° PlanCard æ­¥éª¤åˆ—è¡¨ |
| `plan_approval_request` | Phase 2 å…¥å£ | å‰ç«¯æ˜¾ç¤ºç¡®è®¤æŒ‰é’® |

